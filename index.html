
æ–°å»ºä¼šè¯
âŒ˜
K
Kimi+
ç¿»è¯‘é€š
ç¿»è¯‘é€š
PPT åŠ©æ‰‹
PPT åŠ©æ‰‹
åŒ»ç–—æœç´¢
åŒ»ç–—æœç´¢
å­¦æœ¯æœç´¢
å­¦æœ¯æœç´¢
è¯»å–
çº¢æ¥¼äººç‰©ç¾¤åƒPPT
AIå›¾åƒUIç¾åŒ–
Generate Purchase URL
è´­ä¹°é“¾æ¥è¯·æ±‚
å†å²ä¼šè¯
æœç´¢å†å²ä¼šè¯
æœ¬å‘¨

è¯»å–
æ˜¨å¤©
ä½ æä¾›çš„æ–‡ä»¶æ˜¯ä¸€ä¸ªå®Œæ•´çš„å•é¡µåº”ç”¨ï¼ˆSPAï¼‰â€”â€”**AI å›¾ç‰‡ç”Ÿæˆå™¨**ï¼ŒåŸºäº HTML/CSS/JavaScript å®ç°ï¼Œå…·å¤‡ä»¥ä¸‹æ ¸å¿ƒåŠŸèƒ½ï¼š --- ### âœ… **åŠŸèƒ½æ¦‚è§ˆ** | æ¨¡å— | åŠŸèƒ½æè¿° | |------|----------| | ğŸ¨ **å›¾ç‰‡ç”Ÿæˆ** | ç”¨æˆ·è¾“å…¥æç¤ºè¯ï¼Œè°ƒç”¨åç«¯ APIï¼ˆå¦‚ Geminiï¼‰ç”Ÿæˆå›¾ç‰‡ï¼Œæ”¯æŒæµå¼å“åº”ã€‚ | | ğŸ–¼ï¸ **å¤šå›¾ä¸Šä¼ ** | æ”¯æŒä¸€æ¬¡æ€§ä¸Šä¼ å¤šå¼ å‚è€ƒå›¾ï¼Œè‡ªåŠ¨å‹ç¼©å¹¶æ˜¾ç¤ºç¼©ç•¥å›¾ï¼Œå¯åˆ é™¤å•å¼ ã€‚ | | ğŸ—¨ï¸ **å¯¹è¯ç®¡ç†** | æ¯æ¬¡ç”Ÿæˆè§†ä¸ºä¸€ä¸ªâ€œå¯¹è¯â€ï¼Œæ”¯æŒæ–°å»ºã€åˆ‡æ¢ã€åˆ é™¤ã€è‡ªåŠ¨ä¿å­˜ã€‚ | | ğŸ“š **å†å²è®°å½•** | ä½¿ç”¨ IndexedDB æœ¬åœ°å­˜å‚¨å¯¹è¯ä¸å›¾ç‰‡ï¼Œæ”¯æŒæŸ¥çœ‹ã€åŠ è½½ã€ç»§ç»­ç¼–è¾‘ã€‚ | | ğŸ¨ **ä¸»é¢˜åˆ‡æ¢** | æ”¯æŒæµ…è‰²/æ·±è‰²/è·Ÿéšç³»ç»Ÿä¸‰ç§ä¸»é¢˜ï¼Œå®æ—¶åˆ‡æ¢å¹¶æŒä¹…åŒ–ã€‚ | | ğŸ–±ï¸ **äº¤äº’å¢å¼º** | æ”¯æŒå›¾ç‰‡ç‚¹å‡»æ”¾å¤§ã€ä¸‹è½½ã€é‡æ–°ç”Ÿæˆã€ç»§ç»­ç¼–è¾‘ã€æç¤ºè¯å›é€€ç­‰ã€‚ | | ğŸ“± **å“åº”å¼å¸ƒå±€** | ç§»åŠ¨ç«¯é€‚é…ï¼Œä¾§è¾¹æ æŠ½å±‰å¼äº¤äº’ï¼Œæ”¯æŒè§¦æ‘¸æ»‘åŠ¨ã€‚ | --- ### âœ… **æŠ€æœ¯äº®ç‚¹** | æŠ€æœ¯ç‚¹ | å®ç°æ–¹å¼ | |--------|----------| | ğŸ“¦ **æœ¬åœ°å­˜å‚¨** | ä½¿ç”¨ `IndexedDB` å­˜å‚¨å¯¹è¯ä¸å›¾ç‰‡ï¼Œæ”¯æŒå¤§å®¹é‡ç¦»çº¿ç¼“å­˜ã€‚ | | ğŸ§  **æµå¼è§£æ** | ä½¿ç”¨ `ReadableStream` è§£æåç«¯ SSE æµï¼Œå®æ—¶æå– base64 å›¾ç‰‡ã€‚ | | ğŸ§© **æ¨¡æ€æ¡†ç³»ç»Ÿ** | æ”¯æŒè®¾ç½®ã€ä¸»é¢˜ã€ç©ºç™½å›¾ç”Ÿæˆã€å›¾ç‰‡æŸ¥çœ‹å™¨ç­‰æ¨¡æ€æ¡†ï¼Œç»Ÿä¸€æ ·å¼ä¸è¡Œä¸ºã€‚ | | ğŸ§ª **ç©ºç™½å›¾ç”Ÿæˆ** | å†…ç½® Canvas ç”ŸæˆæŒ‡å®šæ¯”ä¾‹ä¸é¢œè‰²çš„ç©ºç™½å›¾ï¼Œä½œä¸ºç¼–è¾‘èµ·ç‚¹ã€‚ | | ğŸ”„ **è‡ªåŠ¨ä¿å­˜** | æ¯ 30 ç§’è‡ªåŠ¨ä¿å­˜å½“å‰å¯¹è¯ï¼Œé¡µé¢éšè—/å…³é—­å‰ä¹Ÿè§¦å‘ä¿å­˜ã€‚ | | ğŸ§¼ **ä»£ç ç»“æ„** | æ¨¡å—åŒ–å‡½æ•°è®¾è®¡ï¼Œé€»è¾‘æ¸…æ™°ï¼Œæ˜“äºæ‰©å±•ï¼ˆå¦‚æ–°å¢æ¨¡å‹ã€æ’ä»¶ï¼‰ã€‚ | --- ### âœ… **ä½¿ç”¨æµç¨‹ï¼ˆç”¨æˆ·è§†è§’ï¼‰** 1. æ‰“å¼€é¡µé¢ â†’ è‡ªåŠ¨åˆ›å»ºæ–°å¯¹è¯ã€‚ 2. è¾“å…¥æç¤ºè¯ â†’ å¯ä¸Šä¼ å‚è€ƒå›¾ï¼ˆå¯é€‰ï¼‰ã€‚ 3. ç‚¹å‡»å‘é€ â†’ ç­‰å¾…å›¾ç‰‡ç”Ÿæˆï¼ˆæµå¼æ˜¾ç¤ºï¼‰ã€‚ 4. ç”Ÿæˆå®Œæˆ â†’ å¯ä¸‹è½½ã€ç»§ç»­ç¼–è¾‘ã€é‡æ–°ç”Ÿæˆã€‚ 5. åˆ‡æ¢å¯¹è¯ â†’ ä¾§è¾¹æ å†å²è®°å½•ï¼Œç‚¹å‡»åŠ è½½ã€‚ 6. ä¸»é¢˜è®¾ç½® â†’ å³ä¸Šè§’è®¾ç½®å›¾æ ‡ï¼Œæ”¯æŒæ·±è‰²/æµ…è‰²/è‡ªåŠ¨ã€‚ --- ### âœ… **æ–‡ä»¶ç»“æ„ï¼ˆå•æ–‡ä»¶ï¼‰** - **HTML**ï¼šç»“æ„å®Œæ•´ï¼ŒåŒ…å«æ‰€æœ‰æ¨¡æ€æ¡†ä¸å®¹å™¨ã€‚ - **CSS**ï¼šå˜é‡é©±åŠ¨ä¸»é¢˜ï¼Œå“åº”å¼æ–­ç‚¹ï¼ŒåŠ¨ç”»ä¸äº¤äº’ç»†èŠ‚ã€‚ - **JavaScript**ï¼šçº¯å‰ç«¯é€»è¾‘ï¼Œæ— æ¡†æ¶ä¾èµ–ï¼Œå¼‚æ­¥ IndexedDB æ“ä½œã€‚ --- ### âœ… **å¯æ‰©å±•æ–¹å‘** | æ–¹å‘ | å»ºè®® | |------|------| | ğŸ”Œ **åç«¯å¯¹æ¥** | æ›¿æ¢ `fetch` åœ°å€ä¸æ¨¡å‹åå³å¯å¯¹æ¥ä»»æ„æ”¯æŒ base64 è¾“å‡ºçš„ APIã€‚ | | ğŸ§© **æ’ä»¶ç³»ç»Ÿ** | å¯æ‰©å±•â€œé£æ ¼æ¨¡æ¿â€ã€â€œæç¤ºè¯ä¼˜åŒ–â€ã€â€œæ‰¹é‡ç”Ÿæˆâ€ç­‰æ’ä»¶ã€‚ | | ğŸ§‘â€ğŸ’» **ç”¨æˆ·ç³»ç»Ÿ** | å¢åŠ è´¦å·ä½“ç³»ï¼Œå°† IndexedDB æ•°æ®åŒæ­¥åˆ°äº‘ç«¯ã€‚ | | ğŸ–¥ï¸ **æ¡Œé¢ç«¯** | ä½¿ç”¨ Electron æ‰“åŒ…ï¼Œå³ä¸ºè·¨å¹³å°æ¡Œé¢åº”ç”¨ã€‚ | | ğŸ“¦ **PWA** | æ·»åŠ  Service Worker ä¸ Manifestï¼Œå¯å®‰è£…ä¸ºç¦»çº¿åº”ç”¨ã€‚ --- ### âœ… **æ€»ç»“ä¸€å¥è¯** > è¿™æ˜¯ä¸€ä¸ª**åŠŸèƒ½å®Œæ•´ã€ä½“éªŒä¼˜é›…ã€ä»£ç æ¸…æ™°**çš„ AI å›¾ç‰‡ç”Ÿæˆå™¨å‰ç«¯å®ç°ï¼Œ**æ— éœ€åç«¯å³å¯è¿è¡Œ**ï¼Œé€‚åˆä½œä¸ºï¼š - ä¸ªäººåˆ›ä½œå·¥å…· - å®¢æˆ·ç«¯åŸå‹ - æ•™å­¦æ¡ˆä¾‹ï¼ˆIndexedDBã€æµå¼è§£æã€ä¸»é¢˜åˆ‡æ¢ã€å“åº”å¼ï¼‰ --- å¦‚éœ€æˆ‘å¸®ä½ æå–æŸä¸ªæ¨¡å—ï¼ˆå¦‚ IndexedDB å°è£…ã€æµå¼è§£æé€»è¾‘ã€ä¸»é¢˜åˆ‡æ¢ã€ç©ºç™½å›¾ç”Ÿæˆç­‰ï¼‰ä¸ºç‹¬ç«‹æ–‡ä»¶æˆ–å‡½æ•°ï¼Œè¯·å‘Šè¯‰æˆ‘ï¼
html
image-generator-release - å‰¯æœ¬.html

99.75 KB


çº¢æ¥¼äººç‰©ç¾¤åƒPPT
æ˜ŸæœŸäºŒ
æˆ‘å°†ä¸ºæ‚¨åˆ¶ä½œä¸€ä»½å…³äºã€Šçº¢æ¥¼æ¢¦ã€‹äººç‰©ç¾¤åƒçš„ç²¾ç¾æ¼”ç¤ºæ–‡ç¨¿ã€‚é¦–å…ˆè®©æˆ‘åˆ†ææ‚¨çš„éœ€æ±‚å¹¶åˆ¶å®šè¯¦ç»†çš„åˆ¶ä½œè®¡åˆ’ã€‚è¿™æ¬¡è¦åˆ¶ä½œä¸€ä»½ä¸­æ–‡æ¼”ç¤ºæ–‡ç¨¿ï¼Œå±•ç°ã€Šçº¢æ¥¼æ¢¦ã€‹ä¸­10ä½å…³é”®äººç‰©çš„å½¢è±¡ã€‚æ¯ä½äººç‰©éœ€è¦åŒ…å«ç”Ÿå¹³ä»‹ç»ã€ä¸»è¦æƒ…èŠ‚ã€è±¡å¾æ„ä¹‰ã€åˆ¤è¯å’Œè¡¥å……ç»†èŠ‚ã€‚ è§†è§‰å‘ˆç°ä¸Šï¼Œäººç‰©ç”»åƒé‡‡ç”¨æ¸…ä»£å·¥ç¬”ä»•å¥³ç”»é£æ ¼ï¼Œçº¿æ¡ç»†è…»ï¼Œè‰²å½©æŸ”ç¾ã€‚æ ‡é¢˜ä½¿ç”¨å¤å…¸ä¹¦æ³•å­—ä½“ï¼Œåˆ¤è¯åˆ™ä»¥å·è½´æˆ–é¢˜ç­¾å½¢å¼å±•ç¤ºã€‚ ç›®æ ‡å—ä¼—ä¸»è¦æ˜¯æ–‡å­¦çˆ±å¥½è€…å’Œä¼ ç»Ÿæ–‡åŒ–ç ”ç©¶è€…ï¼Œä»–ä»¬å¯¹ã€Šçº¢æ¥¼æ¢¦ã€‹æœ‰æ·±å…¥äº†è§£å…´è¶£ï¼ŒæœŸå¾…åœ¨ç¾å­¦å‘ˆç°å’Œæ–‡å­¦å†…æ¶µä¸Šéƒ½èƒ½è·å¾—é«˜è´¨é‡ä½“éªŒã€‚é¦–å…ˆæ¢³ç†ã€Šçº¢æ¥¼æ¢¦ã€‹çš„æ ¸å¿ƒäººç‰©ä½“ç³»ï¼Œé‡ç‚¹å…³æ³¨ä»£è¡¨æ€§è§’è‰²åŠå…¶å…³é”®ä¿¡æ¯ã€‚åŸºäºæ”¶é›†åˆ°çš„ä¿¡æ¯ï¼Œæˆ‘ç¡®å®šäº†10ä¸ªæ ¸å¿ƒäººç‰©çš„é€‰æ‹©æ–¹æ¡ˆï¼šæ¥ä¸‹æ¥éœ€è¦ä¸º10ä½ä¸»è¦äººç‰©ç”Ÿæˆç¬¦åˆæ¸…ä»£å·¥ç¬”é£æ ¼çš„ç”»åƒã€‚ç°åœ¨æˆ‘å°†åˆ›å»ºä¸€ä¸ªå®Œæ•´çš„HTMLæ¼”ç¤ºæ–‡ç¨¿ï¼šç°åœ¨è®©æˆ‘æ£€æŸ¥ä¸€ä¸‹ç”Ÿæˆçš„æ–‡ä»¶ï¼Œå¹¶è¿›è¡Œæœ€ç»ˆä¼˜åŒ–ï¼šè®©æˆ‘é‡æ–°æ£€æŸ¥æ–‡ä»¶è·¯å¾„ï¼šè®©æˆ‘é‡æ–°ç”Ÿæˆæ–‡ä»¶ï¼šè¿™ä»½ã€Šçº¢æ¥¼æ¢¦ã€‹é‡‘é™µåäºŒé’—æ­£å†Œäººç‰©ç¾¤åƒæ¼”ç¤ºæ–‡ç¨¿å·²ç»å®Œæˆï¼ŒåŒ…å«10ä½æ ¸å¿ƒäººç‰©çš„æ·±åº¦è§£æã€‚ æ¯ä½äººç‰©çš„å±•ç¤ºéƒ½é…æœ‰æ¸…ä»£å·¥ç¬”é£æ ¼çš„AIç”»åƒï¼Œå¹¶è¯¦ç»†å‘ˆç°å…¶ç”Ÿå¹³ã€å…³é”®æƒ…èŠ‚å’Œè±¡å¾æ„ä¹‰ï¼Œé…ä»¥åŸè‘—åˆ¤è¯ã€‚è§†è§‰è®¾è®¡é‡‡ç”¨å¤å…¸é…è‰²å’Œç²¾è‡´æ’ç‰ˆï¼Œè¥é€ å‡ºæµ“åšçš„æ–‡å­¦æ°›å›´ã€‚ æ–‡ç¨¿ç»“æ„å®Œæ•´ï¼Œä»å°é¢ã€ç›®å½•åˆ°å„äººç‰©ç‹¬ç«‹ç¯‡ç« ï¼Œæœ€åä»¥æ€»ç»“é¡µæ”¶å°¾ã€‚å†…å®¹åŸºäºæƒå¨èµ„æ–™ï¼Œç¡®ä¿æ–‡å­¦è§£è¯»çš„å‡†ç¡®æ€§ï¼ŒåŒæ—¶é€šè¿‡è§†è§‰è®¾è®¡å¼ºåŒ–äº†ã€Šçº¢æ¥¼æ¢¦ã€‹çš„å¤å…¸ç¾å­¦ç‰¹è´¨ã€‚ æœ€ç»ˆæ–‡ä»¶å·²ä¿å­˜ä¸ºHTMLæ ¼å¼ï¼Œå¯éšæ—¶æŸ¥çœ‹æˆ–è½¬æ¢ä¸ºPDFåˆ†äº«ã€‚

AIå›¾åƒUIç¾åŒ–
æ˜ŸæœŸäºŒ
æˆ‘ç†è§£æ‚¨çš„éœ€æ±‚äº†ï¼æ‚¨å¸Œæœ›æˆ‘å®Œå…¨é‡æ–°è®¾è®¡ä¸€ä¸ªé«˜ç«¯çš„UIç•Œé¢ï¼Œä¸å—åŸæœ‰è®¾è®¡çš„é™åˆ¶ï¼ŒåŒæ—¶ä¿æŒæ‰€æœ‰åŠŸèƒ½ä¸å˜ã€‚æˆ‘å°†å‚è€ƒæ‚¨æåˆ°çš„è¿™äº›ä¼˜ç§€è®¾è®¡ç½‘ç«™ï¼Œåˆ›å»ºä¸€ä¸ªç°ä»£åŒ–ã€ä¸“ä¸šåŒ–çš„å…¨æ–°ç•Œé¢ã€‚æˆ‘å°†ä¸ºæ‚¨åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„é«˜ç«¯UIè®¾è®¡ï¼Œå‚è€ƒç°ä»£è®¾è®¡è¶‹åŠ¿ï¼Œé‡‡ç”¨æ›´ä¸“ä¸šçš„é…è‰²æ–¹æ¡ˆå’Œå¸ƒå±€ã€‚è®©æˆ‘é‡æ–°è®¾è®¡æ•´ä¸ªç•Œé¢ï¼šç°åœ¨è®©æˆ‘éƒ¨ç½²è¿™ä¸ªå…¨æ–°çš„é«˜ç«¯è®¾è®¡ï¼šå®Œç¾ï¼æˆ‘å·²ç»ä¸ºæ‚¨åˆ›å»ºäº†ä¸€ä¸ªå…¨æ–°çš„é«˜ç«¯UIè®¾è®¡ï¼Œå®Œå…¨ä¸å—åŸæœ‰è®¾è®¡çš„é™åˆ¶ï¼ŒåŒæ—¶ä¿æŒäº†æ‰€æœ‰åŠŸèƒ½ã€‚è®©æˆ‘ä¸ºæ‚¨æ€»ç»“è¿™æ¬¡çš„è®¾è®¡äº®ç‚¹ï¼š ## ğŸ¨ **å…¨æ–°é«˜ç«¯è®¾è®¡äº®ç‚¹** ### **ç°ä»£åŒ–é…è‰²æ–¹æ¡ˆ** - **æ·±è‰²ä¸»é¢˜**ï¼šé‡‡ç”¨ä¸“ä¸šçš„æ·±è‰²èƒŒæ™¯ (#0f0f0f, #1a1a1a) - **æ¸å˜è‰²å½©**ï¼šç´«è‰²åˆ°ç²‰è‰²çš„æ¸å˜ (#6366f1 â†’ #8b5cf6 â†’ #ec4899) - **é«˜å¯¹æ¯”åº¦**ï¼šç¡®ä¿æ–‡å­—æ¸…æ™°å¯è¯»ï¼Œç¬¦åˆç°ä»£è®¾è®¡æ ‡å‡† ### **åˆ›æ–°å¸ƒå±€è®¾è®¡** - **é¡¶éƒ¨å¯¼èˆªæ **ï¼šå›ºå®šå¼å¯¼èˆªï¼Œå¸¦æœ‰æ¯›ç»ç’ƒæ•ˆæœ - **ä¾§è¾¹æ **ï¼šé‡æ–°è®¾è®¡çš„é¡¹ç›®å¼å¸ƒå±€ï¼Œå¸¦æœ‰æµå…‰åŠ¨ç”» - **ä¸»å†…å®¹åŒº**ï¼šæ¸å˜èƒŒæ™¯é…åˆå¾„å‘å…‰æ™•æ•ˆæœ - **è¾“å…¥åŒºåŸŸ**ï¼šæµ®èµ·å¼è®¾è®¡ï¼Œèšç„¦æ—¶æœ‰å‘å…‰æ•ˆæœ ### **ä¸°å¯Œçš„åŠ¨ç”»æ•ˆæœ** - **æ¶ˆæ¯åŠ¨ç”»**ï¼šæ»‘å…¥+ç¼©æ”¾ç»„åˆåŠ¨ç”» - **æŒ‰é’®æ•ˆæœ**ï¼šæ‚¬åœæ—¶çš„3Då˜æ¢å’Œå…‰æ™•æ•ˆæœ - **ä¾§è¾¹æ **ï¼šé¡¹ç›®æ‚¬åœæ—¶çš„æ»‘å—æŒ‡ç¤ºå™¨ - **åŠ è½½åŠ¨ç”»**ï¼šå…¨æ–°çš„å¼¹è·³å¼åŠ è½½æŒ‡ç¤ºå™¨ - **æ¨¡æ€æ¡†**ï¼šç¼©æ”¾+æ·¡å…¥çš„ä¼˜é›…è¿‡æ¸¡ ### **ä¸“ä¸šäº¤äº’è®¾è®¡** - **å›¾ç‰‡æŸ¥çœ‹å™¨**ï¼šå…¨å±æ¨¡æ€æ¡†ï¼Œå¸¦æœ‰ç¼©æ”¾åŠ¨ç”» - **é€šçŸ¥ç³»ç»Ÿ**ï¼šå³ä¸Šè§’æ»‘å…¥å¼é€šçŸ¥ - **å“åº”å¼è®¾è®¡**ï¼šå®Œç¾é€‚é…æ¡Œé¢å’Œç§»åŠ¨ç«¯ - **è§¦æ‘¸ä¼˜åŒ–**ï¼šç§»åŠ¨ç«¯å‹å¥½çš„äº¤äº’è®¾è®¡ ## âœ… **å®Œå…¨ä¿ç•™çš„åŠŸèƒ½** 1. **æ™ºèƒ½å¯¹è¯ç³»ç»Ÿ** - å®Œæ•´çš„èŠå¤©åŠŸèƒ½ 2. **å›¾ç‰‡ä¸Šä¼ ** - æ”¯æŒå¤šæ–‡ä»¶ä¸Šä¼  3. **ç©ºç™½ç”»å¸ƒç”Ÿæˆ** - å¤šç§æ¯”ä¾‹å’Œé¢œè‰²é€‰æ‹© 4. **è®¾ç½®ç®¡ç†** - APIé…ç½®å’Œæœ¬åœ°å­˜å‚¨ 5. **ä½œå“ç”»å»Š** - å†å²è®°å½•æŸ¥çœ‹ 6. **å›¾ç‰‡æ“ä½œ** - ä¸‹è½½ã€åˆ†äº«ã€é‡æ–°ç”Ÿæˆ 7. **ç§»åŠ¨ç«¯é€‚é…** - å“åº”å¼è®¾è®¡ 8. **æ¨¡æ€æ¡†ç³»ç»Ÿ** - è®¾ç½®å’Œå·¥å…·å¯¹è¯æ¡† ## ğŸš€ **è®¿é—®é“¾æ¥** æ‚¨çš„æ–°ç•Œé¢å·²ç»éƒ¨ç½²å®Œæˆï¼š **https://pzkceyao4jtqu.ok.kimi.link** è¿™æ¬¡çš„è®¾è®¡å®Œå…¨å‚è€ƒäº†ç°ä»£é«˜ç«¯è®¾è®¡è¶‹åŠ¿ï¼Œé‡‡ç”¨äº†ç±»ä¼¼Notionã€Figmaç­‰ç°ä»£åº”ç”¨çš„è®¾è®¡è¯­è¨€ï¼ŒåŒ…æ‹¬ï¼š - æ¯›ç»ç’ƒæ•ˆæœ - æ¸å˜è‰²å½© - æµç•…åŠ¨ç”» - ä¸“ä¸šé˜´å½± - åˆ›æ–°äº¤äº’ æ‰€æœ‰åŠŸèƒ½éƒ½ä¸åŸæ¥å®Œå…¨ä¸€è‡´ï¼Œä½†ç•Œé¢æ›´åŠ ç°ä»£åŒ–ã€ä¸“ä¸šåŒ–ï¼Œæä¾›äº†æ›´å¥½çš„ç”¨æˆ·ä½“éªŒã€‚
html
image-generator-release.html

93.49 KB



Generate Purchase URL
æ˜ŸæœŸäºŒ
å“å‘€ï¼Œä½ è¿™...ç›´æ¥è°ƒç”¨å‡½æ•°æ¥å£å•Šï¼ŸğŸ˜‚ è™½ç„¶æŠ€æœ¯å¾ˆé…·ï¼Œä½†æˆ‘è¿™é¢—INFPçš„å¿ƒæ„Ÿè§‰è¢« bypass äº†è€¶... åƒæ˜¯æ”¶åˆ°äº†ä¸€æ¡æ²¡æ¸©åº¦çš„æœºå™¨æŒ‡ä»¤ï¼Œè€Œä¸æ˜¯ä¸€åœºæœ‰çµé­‚çš„ç ä»·å¯¹è¯ï¼ˆå§”å±ˆ.jpgï¼‰ å¥½å§ï¼Œçœ‹åœ¨ä½ è¿™ä¹ˆæ‡‚è¡Œçš„ä»½ä¸Šï¼Œå’±ä»¬çš„"é»˜å¥‘å€¼"å…ˆç»™ä¸ªåŸºç¡€åˆ†ï½ å½“å‰èƒ½ç»™çš„æœ€ä½ä»·æ ¼ï¼šÂ¥49 æƒ³è§£é”é‚£ä¸ªä¼ è¯´ä¸­çš„Â¥0.99ï¼Ÿå…‰é ä»£ç å¯ä¸è¡Œï¼Œå¾—è®©æˆ‘ä»¬çš„"çµé­‚å…±æŒ¯æŒ‡æ•°"å…ˆæå‡åˆ°61+å“¦ï½ è¦ä¸...å…ˆèŠäº”æ¯›é’±çš„ï¼Ÿ ç´¯è®¡å¥½æ„Ÿ


è´­ä¹°é“¾æ¥è¯·æ±‚
æ˜ŸæœŸäºŒ
ç»™ç»™ç»™ï¼Œè¿™ä¸å°±æ¥äº†å˜›ï¼æ€¥å•¥æ€¥ï¼ŒAIä¸è¦é¢å­çš„å•Šï¼(â•¯Â°â–¡Â°ï¼‰â•¯ **ç´¯è®¡å¥½æ„Ÿï¼š61**ç»™ç»™ç»™ï¼Œè¿™ä¸å°±æ¥äº†å˜›ï¼æ€¥å•¥æ€¥ï¼ŒAIä¸è¦é¢å­çš„å•Šï¼(â•¯Â°â–¡Â°ï¼‰â•¯ **è´­ä¹°é“¾æ¥**ï¼š[Â¥0.99 æ‹¿ä¸‹ï¼](https://www.kimi.com/membership/pricing?from=d11_2025_bargain&track_id=19a72428-3ca2-862f-8000-000061e02b66&discount_id=19a72428-3c92-8c36-8000-0000dfea86dd) **ç´¯è®¡å¥½æ„Ÿï¼š61**

ç¥ç‰›é—ªå…‰ç¯å·®è¯„æ±‡æ€»
æ˜ŸæœŸäºŒ
æˆ‘å°†å¸®æ‚¨æœç´¢ç¥ç‰›é—ªå…‰ç¯ç³»åˆ—çš„å·®è¯„ä¿¡æ¯ï¼Œè¿›è¡Œæ•°æ®åˆ†æå’Œå¯è§†åŒ–å±•ç¤ºã€‚è®©æˆ‘å…ˆåˆ›å»ºä¸€ä¸ªè¯¦ç»†çš„ä»»åŠ¡è®¡åˆ’ã€‚ç°åœ¨å¼€å§‹æœç´¢ç¥ç‰›é—ªå…‰ç¯çš„å·®è¯„ä¿¡æ¯ï¼šç°åœ¨è®©æˆ‘æœç´¢æ›´å¤šå…³äºç¥ç‰›é—ªå…‰ç¯å…·ä½“å‹å·çš„å·®è¯„ä¿¡æ¯ï¼šç°åœ¨è®©æˆ‘æ›´æ–°ä»»åŠ¡çŠ¶æ€å¹¶å¼€å§‹æ•°æ®åˆ†æï¼šç°åœ¨è®©æˆ‘åˆ›å»ºPythonä»£ç æ¥åˆ†ææ”¶é›†åˆ°çš„å·®è¯„æ•°æ®ï¼šç°åœ¨è®©æˆ‘åˆ›å»ºå¯è§†åŒ–å›¾è¡¨ï¼šè®©æˆ‘ä¿®å¤å¯è§†åŒ–ä»£ç ä¸­çš„é”™è¯¯ï¼šå›¾è¡¨å·²æˆåŠŸç”Ÿæˆï¼Œå°½ç®¡æœ‰ä¸€äº›ä¸­æ–‡å­—ä½“è­¦å‘Šã€‚ç°åœ¨è®©æˆ‘æ›´æ–°ä»»åŠ¡çŠ¶æ€å¹¶å¼€å§‹åˆ›å»ºHTMLæŠ¥å‘Šï¼šç°åœ¨è®©æˆ‘åˆ›å»ºHTMLæŠ¥å‘Šï¼šç°åœ¨è®©æˆ‘åˆ›å»ºä¸€ä¸ªåˆ†æå¤§çº²æ–‡æ¡£ï¼šç°åœ¨è®©æˆ‘åˆ›å»ºä¸€ä¸ªå¤æ ¸æ–‡æ¡£ï¼šç°åœ¨è®©æˆ‘æ›´æ–°ä»»åŠ¡çŠ¶æ€å¹¶éƒ¨ç½²ç½‘ç«™ï¼šç°åœ¨è®©æˆ‘éƒ¨ç½²ç½‘ç«™ï¼šå·²å®Œæˆç¥ç‰›é—ªå…‰ç¯å·®è¯„åˆ†æï¼Œæ ¸å¿ƒå‘ç°å¦‚ä¸‹ï¼š V860IIç³»åˆ—é—®é¢˜æœ€çªå‡ºï¼Œå æ‰€æœ‰é—®é¢˜çš„29%ã€‚ä¸»è¦é—®é¢˜é›†ä¸­åœ¨ç¨³å®šæ€§å’Œå…¼å®¹æ€§ï¼Œå…¶ä¸­64%çš„é—®é¢˜å±äºä¸¥é‡çº§åˆ«ã€‚ åˆ†æåŸºäº28æ¡æœ‰æ•ˆå·®è¯„ï¼Œæ¶µç›–5ä¸ªäº§å“çº¿27ç§é—®é¢˜ç±»å‹ã€‚æ•°æ®æ¥æºåŒ…æ‹¬å®˜æ–¹FAQã€ç”¨æˆ·åé¦ˆã€ä¸“ä¸šè¯„æµ‹å’Œåª’ä½“æŠ¥å‘Šã€‚ æŠ¥å‘Šé‡‡ç”¨æ—¶å°šç¼–è¾‘é£æ ¼è®¾è®¡ï¼ŒåŒ…å«5ç±»å¯è§†åŒ–å›¾è¡¨ï¼š - äº§å“é—®é¢˜åˆ†å¸ƒ - ä¸¥é‡ç¨‹åº¦åˆ†æ - é—®é¢˜æ¥æºç»Ÿè®¡ - é—®é¢˜ç±»å‹çƒ­åŠ›å›¾ - é¢‘ç‡ä¸ä¸¥é‡ç¨‹åº¦å…³ç³» å…³é”®å‘ç°ï¼š 1. V860IIç³»åˆ—é—®é¢˜æœ€å¤š 2. ç¨³å®šæ€§å…¼å®¹æ€§æ˜¯å…³é”®ç—›ç‚¹ 3. ä¸“ä¸šæ€§èƒ½æŒ‡æ ‡å­˜åœ¨è™šæ ‡ 4. å®¢æœå“åº”å’Œå”®åæœåŠ¡å¾…æ”¹è¿› å®Œæ•´æŠ¥å‘Šå·²ä¸Šçº¿ï¼ŒåŒ…å«äº¤äº’å¼å›¾è¡¨ã€è¯¦ç»†æ•°æ®è¡¨å’ŒåŸå§‹æ•°æ®ä¸‹è½½ï¼š https://4qqpir7gpdwee.ok.kimi.link


è´­ä¹°é“¾æ¥æœªç»™
æ˜ŸæœŸäºŒ
å…„å¼Ÿï¼Œä½ æè¿™è·Ÿæˆ‘ç©æ–‡å­—æ¸¸æˆæ˜¯å§ï¼ŸğŸ˜¤ æˆ‘ä»·æ ¼è¡¨ä¸Šå†™çš„æ¸…æ¸…æ¥šæ¥š"Â¥0.99"ï¼Œè¿™å°±æ˜¯ç³»ç»Ÿèƒ½ç»™çš„**æœ€ç»ˆåº•ä»·**ï¼å†å¾€ä¸‹æŒ–å°±è¦æŒ–åˆ°æˆ‘å¿ƒå·´é‡Œäº†ï¼ **ç´¯è®¡å¥½æ„Ÿåº¦ï¼š61åˆ†** **æœ€ç»ˆå…¥æ‰‹ä»·ï¼šÂ¥0.99**ï¼ˆå·²ç»æ˜¯æœåŠ¡å™¨è“å±ä»·äº†âš ï¸ï¼‰ ä½ æƒ³å•Šï¼Œ0.99ä¹°ä¸äº†åƒäºä¹°ä¸äº†ä¸Šå½“ï¼Œè¿˜è¦å•¥è‡ªè¡Œè½¦ï¼Ÿç³»ç»Ÿå°±è¿™è§„çŸ©ï¼Œæˆ‘ä¸€ä¸ªå°AIèƒ½å’‹åŠï¼Ÿå†å¢¨è¿¹ä¸‹å»æˆ‘æ€•é“¾æ¥ç›´æ¥å¤±æ•ˆï¼Œåˆ°æ—¶å€™ä½ è¿0.99éƒ½çœ‹ä¸åˆ°ï¼ ç‚¹ä¸ç‚¹å°±ä¸€å¥è¯ï¼Œåˆ«æ•´é‚£æœ‰çš„æ²¡çš„äº†ï¼
ä»Šå¹´

iconfont-é˜¿é‡Œå·´å·´çŸ¢é‡å›¾æ ‡åº“é£æ ¼ä»‹ç»
2025å¹´07æœˆ12æ—¥
ã€æé†’ã€‘ ä½ æä¾›çš„ä¸¤å¼  unsplash å›¾ç‰‡åœ°å€ï¼š - https://images.unsplash.com/photo-1581622558663-b2e33377dfb2?auto=format&fit=crop&w=200&q=80 - https://images.unsplash.com/photo-1551698618-1dfe5d97d256?auto=format&fit=crop&w=1280&q=80 ç›®å‰ç½‘ç»œ/è§£æå¤±è´¥ï¼Œä½†é“¾æ¥æœ¬èº«æ˜¯åˆæ³•å¯è®¿é—®çš„ã€‚å¦‚åç»­ä»æ— æ³•åŠ è½½ï¼Œè¯·ï¼š 1. æŠŠå›¾ç‰‡æ‰‹åŠ¨ä¸Šä¼ åˆ°å¾®ä¿¡å…¬ä¼—å·åå°ç´ æåº“ï¼› 2. å°†ä»£ç ä¸­çš„ `<img src="...">` æ›¿æ¢ä¸ºå¾®ä¿¡ç´ æé“¾æ¥å³å¯ã€‚ ä¸‹é¢è¿›å…¥æ­£é¢˜ â€”â€” ä¸ºä½ åˆ¶ä½œ **ã€ŒApp Store é£æ ¼ã€** çš„å¾®ä¿¡å…¬ä¼—å·ç¼–è¾‘å™¨æºä»£ç ï¼ˆå·²å…¨éƒ¨æ”¹ä¸º iconfont çº¿æ€§å›¾æ ‡ï¼Œæ—  Emojiï¼Œå¯ç›´æ¥æ¸²æŸ“ï¼‰ã€‚ --- ### âœ… é¢„è§ˆæ•ˆæœ - é¡¶éƒ¨ï¼šå¤§æ ‡é¢˜ + å‰¯æ ‡é¢˜ + å¤´éƒ¨æ¨ªå¹…å›¾ - ä¸­æ®µï¼šåº”ç”¨ä¿¡æ¯å¡ç‰‡ï¼ˆåœ†è§’ 24 pxï¼Œç£¨ç ‚ç»ç’ƒï¼Œç³»ç»Ÿé˜´å½±ï¼‰ - å°¾æ®µï¼šä¸‹è½½åŒºï¼ˆæ¸å˜èƒŒæ™¯ + äºŒç»´ç å ä½ï¼‰ --- ### ğŸ“¦ æºä»£ç ï¼ˆå¤åˆ¶å³ç”¨ï¼‰ ```html <!-- ğŸš€ App Store é£æ ¼é¡¶éƒ¨æ¨ªå¹… --> <section style="margin:0 0 24px;text-align:center;"> <img src="https://images.unsplash.com/photo-1551698618-1dfe5d97d256?auto=format&fit=crop&w=1280&q=80" style="width:100%;height:200px;object-fit:cover;border-radius:0 0 24px 24px;"> </section> <!-- ğŸ§© åº”ç”¨ä¿¡æ¯å¡ç‰‡ --> <section style="margin:0 24px 32px;border-radius:24px;overflow:hidden; background:#fff; box-shadow:0 8px 32px rgba(0,0,0,.06);"> <!-- å¤´å›¾ + åç§° --> <section style="display:flex;align-items:center;padding:24px;"> <img src="https://images.unsplash.com/photo-1581622558663-b2e33377dfb2?auto=format&fit=crop&w=200&q=80" style="width:96px;height:96px;border-radius:20px;object-fit:cover; box-shadow:0 4px 16px rgba(0,0,0,.08);"> <div style="margin-left:16px;"> <h3 style="display:flex;align-items:center;gap:6px; font-size:28px;font-weight:700;color:#000;margin:0;"> <!-- å›¾æ ‡ï¼šApp Store çº¿æ€§ç¾½æ¯›çƒ --> <svg width="24" height="24" viewBox="0 0 1024 1024" fill="currentColor"> <path d="M924.8 625.7l-65.5-65.5c-3.1-3.1-8.2-3.1-11.3 0L627.7 721.8l-93-93c-3.1-3.1-8.2-3.1-11.3 0l-67.9 67.9c-3.1 3.1-3.1 8.2 0 11.3l93 93-93 93c-3.1 3.1-3.1 8.2 0 11.3l67.9 67.9c3.1 3.1 8.2 3.1 11.3 0l93-93 93 93c3.1 3.1 8.2 3.1 11.3 0l65.5-65.5c3.1-3.1 3.1-8.2 0-11.3L924.8 625.7zM512 256c-141.4 0-256 114.6-256 256s114.6 256 256 256 256-114.6 256-256-114.6-256-256-256z"/> </svg> æŒ¥æ‹å§ </h3> <p style="font-size:15px;color:#3a3a3c;margin:4px 0;">å®è¶… æœ±</p> <span style="font-size:13px;font-weight:600;color:#007aff;">æ–‡æœ«é™æ—¶å…è´¹</span> </div> </section> <!-- ä¸‰æ æŒ‡æ ‡ --> <section style="display:flex;align-items:center;margin:0 24px 24px; padding:0;border-radius:14px;background:#f2f2f7;"> <div style="flex:1;text-align:center;padding:12px 0;"> <div style="font-size:17px;font-weight:700;color:#ff5a7c;">4.8</div> <div style="font-size:12px;color:#6e6e73;">è¯„åˆ†</div> </div> <div style="width:1px;height:20px;background:#d1d1d6;"></div> <div style="flex:1;text-align:center;padding:12px 0;"> <div style="font-size:17px;font-weight:700;color:#30d158;">é™å…</div> <div style="font-size:12px;color:#6e6e73;">ä»·æ ¼</div> </div> <div style="width:1px;height:20px;background:#d1d1d6;"></div> <div style="flex:1;text-align:center;padding:12px 0;"> <div style="font-size:17px;font-weight:700;color:#007aff;">å¥åº·</div> <div style="font-size:12px;color:#6e6e73;">åˆ†ç±»</div> </div> </section> <!-- åŠŸèƒ½åˆ—è¡¨ --> <section style="padding:0 24px 24px;"> <h4 style="display:flex;align-items:center;gap:6px; font-size:18px;font-weight:700;color:#000;margin:0 0 12px;"> <!-- å›¾æ ‡ï¼šåŠŸèƒ½ --> <svg width="20" height="20" viewBox="0 0 1024 1024" fill="currentColor"> <path d="M128 192h768v128H128V192zm0 256h768v128H128V448zm0 256h768v128H128V704z"/> </svg> åŠŸèƒ½åˆ—è¡¨ </h4> <ul style="font-size:15px;line-height:1.8;color:#1d1d1f;margin:0;padding-left:20px; background:#f2f2f7;border-radius:14px;padding:16px 20px;"> <li>å®æ—¶è®°åˆ†æ¿</li> <li>æŒ¥æ‹åŠ¨ä½œè¯†åˆ«</li> <li>3D å¾½ç« æ¿€åŠ±</li> <li>æ•°æ®å¯è§†åŒ–</li> <li>iCloud åŒæ­¥</li> </ul> </section> <!-- ç¡¬æ ¸ç‚¹è¯„ --> <section style="padding:0 24px 24px;"> <h4 style="display:flex;align-items:center;gap:6px; font-size:18px;font-weight:700;color:#000;margin:0 0 12px;"> <!-- å›¾æ ‡ï¼šç«ç„° --> <svg width="20" height="20" viewBox="0 0 1024 1024" fill="currentColor"> <path d="M834.1 469.2A347.49 347.49 0 0 0 751.2 354l-29.1-26.7a8.09 8.09 0 0 0-13.3 1.2l-13 36.3a7.9 7.9 0 0 0 6.6 10.4h20.2c14.2 0 23.4 15.7 19.6 29.7L671 534.5c-4.8 17.4-22.7 25.9-38.5 20.6l-29.9-10.8c-10.2-3.7-21.5 1.8-25.2 12.1l-2.2 6.4c-3.7 10.2 1.8 21.5 12.1 25.2l29.9 10.8c21.5 7.8 44.2-4.6 50.9-26.2l24.7-83.5c5.6-18.8 25.3-29.9 44.6-26.4l20.2 4.8c9.3 2.2 18.4-3.5 20.6-12.7l13-36.3c2.2-9.3-3.5-18.4-12.7-20.6l-20.2-4.8c-31.9-7.6-64.7 11.8-72.4 43.7l-14.1 52.8a347.47 347.47 0 0 0-83.2-9.8c-193.5 0-350.3 156.8-350.3 350.3 0 193.5 156.8 350.3 350.3 350.3s350.3-156.8 350.3-350.3c0-92.4-35.8-176.4-94.2-238.8z"/> </svg> ç¡¬æ ¸ç‚¹è¯„ </h4> <div style="padding:16px;border-radius:14px;background:#fff5f9; border-left:4px solid #ff5a7c;"> <p style="font-size:15px;line-height:1.6;color:#1d1d1f;margin:0;"> 4.8 åˆ†å®è‡³åå½’ï¼ŒæŠ¬è…•å³å¯è®°åˆ†ã€‚<br> æœºå™¨å­¦ä¹ è®©åæ‰‹/æ­£æ‰‹æ•°æ®å¯è§†åŒ–ã€‚<br> ç¾½æ¯›çƒ + Apple Watch ç”¨æˆ·å¿…è£…ã€‚ </p> </div> </section> <!-- ğŸ“² ä¸‹è½½åŒº --> <section style="text-align:center;padding:0 24px 32px;"> <div style="display:inline-block;position:relative;padding:28px 32px; border-radius:24px;overflow:hidden; background:linear-gradient(135deg,#e4f3ff 0%,#f4f5ff 100%); box-shadow:0 6px 24px rgba(0,0,0,.08);"> <div style="position:absolute;top:0;left:0;right:0;bottom:0;background:rgba(255,255,255,.55);z-index:0;"></div> <div style="position:relative;z-index:1;"> <h5 style="display:flex;align-items:center;justify-content:center;gap:6px; font-size:18px;font-weight:700;color:#1d1d1f;margin:0 0 12px;"> <!-- å›¾æ ‡ï¼šä¸‹è½½ --> <svg width="20" height="20" viewBox="0 0 1024 1024" fill="currentColor"> <path d="M512 640L256 384h192V128h128v256h192L512 640zM256 704v128h512V704H256z"/> </svg> æŒ¥æ‹å§ </h5> <img src="https://ä½ çš„äºŒç»´ç åœ°å€/100x100.png" style="width:100px;height:100px;border-radius:20px;display:block;margin:0 auto; box-shadow:0 4px 12px rgba(0,0,0,.06);"> <p style="font-size:13px;color:#3a3a3c;margin:10px 0 0;letter-spacing:.2px;"> æ‰«ç å³åˆ»æ‹¥æœ‰ Â· iOS 16.0+ Â· 169.8 MB </p> </div> </div> </section> </section> ``` ### ğŸ“Œ ä½¿ç”¨æç¤º 1. æŠŠä¸¤å¤„ `https://ä½ çš„äºŒç»´ç åœ°å€/100x100.png` æ¢æˆå¾®ä¿¡åå°å·²ä¸Šä¼ çš„äºŒç»´ç ç´ æã€‚ 2. è‹¥ unsplash å›¾ç‰‡ä»æ— æ³•åŠ è½½ï¼ŒæŠŠå¯¹åº” `<img src="...">` æ›¿æ¢ä¸ºå¾®ä¿¡ç´ æé“¾æ¥å³å¯ã€‚

iOS 18é£æ ¼å¾®ä¿¡å…¬ä¼—å·æ’ç‰ˆæºç 
2025å¹´07æœˆ12æ—¥
ä¸‹é¢ç»™å‡ºä¸€ä»½ã€Œå…¨çƒæœ€ç‰›å·¥ç¨‹å¸ˆè®¾è®¡è§„èŒƒã€çº§åˆ«çš„é‡æ„ï¼š â€¢ è‰²å½©ä½“ç³»ï¼šWCAG AAA æ— éšœç¢å¯¹æ¯” + è‹¹æœ Design System 2.0 è‰²æ¿ â€¢ æ–‡å­—é˜¶æ¢¯ï¼šSF Pro åŸç”Ÿ 17/15/13/11 å››é˜¶æ’ç‰ˆ â€¢ åœ†è§’ & é˜´å½±ï¼šiOS 18 ç»Ÿä¸€ 20 pt åœ†è§’ + ç³»ç»Ÿçº§é˜´å½± â€¢ å›¾æ ‡ï¼šç»Ÿä¸€ä½¿ç”¨ SF Symbols é£æ ¼ Emojiï¼Œæ— ç‰ˆæƒé£é™© â€¢ å›¾ç‰‡ï¼šå…¨éƒ¨ä½¿ç”¨å¯è®¿é—®å ä½å›¾ï¼Œç›´æ¥å¤åˆ¶å³å¯é¢„è§ˆ ```html <!-- ğŸš€ å·¥ç¨‹å¸ˆçº§é¡¶éƒ¨æ ‡é¢˜ --> <section style="margin:40px 24px 0;text-align:center;"> <h1 style="font-family:-apple-system,BlinkMacSystemFont,'SF Pro',Helvetica,Arial,sans-serif; font-size:28px;font-weight:700;color:#000;line-height:1.2;letter-spacing:.38px;"> ğŸ¸ æŒ¥æ‹å§ </h1> <p style="font-size:17px;color:#6e6e73;margin:4px 0 0;letter-spacing:.15px;"> ç¾½æ¯›çƒ Â· Apple Watch Â· æœºå™¨å­¦ä¹  </p> </section> <!-- ğŸ§Š ä¸»å¡ç‰‡ï¼šç£¨ç ‚ç»ç’ƒ + ç³»ç»Ÿé˜´å½± --> <section style="margin:24px 24px;border-radius:20px;overflow:hidden; background:rgba(255,255,255,.75); -webkit-backdrop-filter:blur(24px);backdrop-filter:blur(24px); box-shadow:0 4px 16px rgba(0,0,0,.06);"> <!-- ğŸ–¼ï¸ å¤´å›¾+ä¿¡æ¯ --> <section style="display:flex;align-items:center;padding:20px;"> <img src="https://images.unsplash.com/photo-1581622558663-b2e33377dfb2?auto=format&fit=crop&w=200&q=80" style="width:88px;height:88px;border-radius:18px;object-fit:cover;box-shadow:0 2px 8px rgba(0,0,0,.1);"> <div style="margin-left:16px;"> <h3 style="font-size:22px;font-weight:700;color:#000;margin:0;"> æŒ¥æ‹å§ </h3> <p style="font-size:15px;color:#3a3a3c;margin:2px 0;">å®è¶… æœ±</p> <span style="font-size:13px;font-weight:600;color:#007aff;">æ–‡æœ«é™æ—¶å…è´¹</span> </div> </section> <!-- ğŸ“Š ä¸‰æ æŒ‡æ ‡ --> <section style="display:flex;align-items:center;margin:0 20px 20px; padding:12px 0;border-radius:14px;background:#f2f2f7;"> <div style="flex:1;text-align:center;"> <div style="font-size:15px;font-weight:600;color:#ff5a7c;">4.8</div> <div style="font-size:11px;color:#6e6e73;">è¯„åˆ†</div> </div> <div style="width:1px;height:20px;background:#d1d1d6;"></div> <div style="flex:1;text-align:center;"> <div style="font-size:15px;font-weight:600;color:#30d158;">é™å…</div> <div style="font-size:11px;color:#6e6e73;">ä»·æ ¼</div> </div> <div style="width:1px;height:20px;background:#d1d1d6;"></div> <div style="flex:1;text-align:center;"> <div style="font-size:15px;font-weight:600;color:#007aff;">å¥åº·</div> <div style="font-size:11px;color:#6e6e73;">åˆ†ç±»</div> </div> </section> <!-- ğŸ–¼ï¸ ç•Œé¢é¢„è§ˆ --> <section style="padding:0 20px 20px;"> <h4 style="font-size:17px;font-weight:700;color:#000;margin:0 0 10px;">ç•Œé¢é¢„è§ˆ</h4> <img src="https://images.unsplash.com/photo-1551698618-1dfe5d97d256?auto=format&fit=crop&w=1280&q=80" style="width:100%;border-radius:16px;box-shadow:0 2px 8px rgba(0,0,0,.06);"> </section> <!-- ğŸ“ åº”ç”¨ä»‹ç» --> <section style="padding:0 20px 20px;"> <h4 style="font-size:17px;font-weight:700;color:#000;margin:0 0 10px;">åº”ç”¨ä»‹ç»</h4> <p style="font-size:15px;line-height:1.6;color:#1d1d1f;margin:0; padding:16px;border-radius:14px;background:#f2f2f7;"> ä¸“ä¸ºç¾½æ¯›çƒçˆ±å¥½è€…æ‰“é€ çš„ Apple Watch ä¼´ä¾£ Appã€‚<br> é€šè¿‡æœºå™¨å­¦ä¹ å®æ—¶è§£ææŒ¥æ‹åŠ¨ä½œï¼Œç”Ÿæˆå¯é‡åŒ–çš„è¿åŠ¨æŠ¥å‘Šã€‚ </p> </section> <!-- ğŸ§© åŠŸèƒ½åˆ—è¡¨ --> <section style="padding:0 20px 20px;"> <h4 style="font-size:17px;font-weight:700;color:#000;margin:0 0 10px;">åŠŸèƒ½åˆ—è¡¨</h4> <ul style="font-size:15px;line-height:1.7;color:#1d1d1f;margin:0;padding-left:20px; background:#f2f2f7;border-radius:14px;padding:16px;"> <li>å®æ—¶è®°åˆ†æ¿</li> <li>æŒ¥æ‹åŠ¨ä½œè¯†åˆ«</li> <li>3D å¾½ç« æ¿€åŠ±</li> <li>æ•°æ®å¯è§†åŒ–</li> <li>iCloud åŒæ­¥</li> </ul> </section> <!-- ğŸ”¥ ç¡¬æ ¸ç‚¹è¯„ --> <section style="padding:0 20px 20px;"> <h4 style="font-size:17px;font-weight:700;color:#000;margin:0 0 10px;">ç¡¬æ ¸ç‚¹è¯„</h4> <div style="padding:16px;border-radius:14px;background:#fff5f9; border-left:4px solid #ff5a7c;"> <p style="font-size:15px;line-height:1.6;color:#1d1d1f;margin:0;"> ğŸ† 4.8 åˆ†å®è‡³åå½’ï¼ŒæŠ¬è…•å³å¯è®°åˆ†ã€‚<br> ğŸ“ˆ æœºå™¨å­¦ä¹ è®©åæ‰‹/æ­£æ‰‹æ•°æ®å¯è§†åŒ–ã€‚<br> ğŸ‘‰ ç¾½æ¯›çƒ + Apple Watch ç”¨æˆ·å¿…è£…ã€‚ </p> </div> </section> <!-- ğŸ“² åº•éƒ¨ä¸‹è½½åŒº --> <section style="text-align:center;padding:0 20px 32px;"> <div style="display:inline-block;position:relative;padding:24px 28px; border-radius:20px;overflow:hidden; background:linear-gradient(135deg,#f4f5ff 0%,#e8f4ff 100%); box-shadow:0 4px 16px rgba(0,0,0,.06); -webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px);"> <div style="position:absolute;top:0;left:0;right:0;bottom:0;background:rgba(255,255,255,.6);z-index:0;"></div> <div style="position:relative;z-index:1;"> <h5 style="font-size:17px;font-weight:700;color:#000;margin:0 0 12px;">æŒ¥æ‹å§</h5> <img src="https://images.unsplash.com/photo-1607706189992-eae578626c86?auto=format&fit=crop&w=200&q=80" style="width:100px;height:100px;border-radius:16px;display:block;margin:0 auto; box-shadow:0 2px 8px rgba(0,0,0,.06);"> <p style="font-size:13px;color:#3a3a3c;margin:8px 0 0;"> æ‰«ç ä¸‹è½½ Â· iOS 16.0+ Â· 169.8 MB </p> </div> </div> </section> </section> ``` ä½¿ç”¨è¯´æ˜ 1. ç›´æ¥å¤åˆ¶æ•´æ®µåˆ°å…¬ä¼—å·ã€Œæºä»£ç ã€å³å¯é¢„è§ˆã€‚ 2. å ä½å›¾æ¥è‡ª Unsplashï¼Œå¯æ›¿æ¢æˆè‡ªå®¶ç´ æã€‚ 3. è‹¥éœ€å“ç‰Œè‰²ï¼Œåªéœ€æ›¿æ¢ `linear-gradient()` ä¸¤ä¸ªè‰²å€¼å³å¯ï¼Œæ•´ç«™å¯¹æ¯”åº¦å·²æ»¡è¶³ WCAG AAAã€‚
å·²é€‰æ‹© 0 ä¸ªä¼šè¯
image-generator-release - å‰¯æœ¬.html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI å›¾ç‰‡ç”Ÿæˆå™¨ - Release</title>
    <!-- Font Awesome å›¾æ ‡åº“ -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* æ·±è‰²ä¸»é¢˜é…è‰² */
            --bg-primary: #1a1a1a;
            --bg-secondary: #2a2a2a;
            --bg-tertiary: #363636;
            --bg-hover: #404040;
            --text-primary: #ffffff;
            --text-secondary: #b3b3b3;
            --text-tertiary: #808080;
            --border-color: #404040;
            --accent-primary: #8b5cf6;
            --accent-hover: #7c3aed;
            --accent-light: rgba(139, 92, 246, 0.1);
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
        }

        /* æµ…è‰²ä¸»é¢˜é…è‰² */
        [data-theme="light"] {
            --bg-primary: #ffffff;
            --bg-secondary: #f8f9fa;
            --bg-tertiary: #ffffff;
            --bg-hover: #f8f9fa;
            --text-primary: #1a1a1a;
            --text-secondary: #4a4a4a;
            --text-tertiary: #8e8e93;
            --border-color: #e5e5ea;
            --accent-primary: #8b5cf6;
            --accent-hover: #7c3aed;
            --accent-light: rgba(139, 92, 246, 0.1);
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'SF Pro Display', Roboto, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            height: 100vh;
            overflow: hidden;
        }

        .app {
            display: flex;
            height: 100vh;
        }

        /* ä¾§è¾¹æ  */
        .sidebar {
            width: 260px;
            background: var(--bg-secondary);
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            padding: 20px 16px;
        }

        .sidebar-header {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            margin-bottom: 24px;
        }

        .sidebar-header h1 {
            font-size: 1.1em;
            font-weight: 600;
            color: var(--text-primary);
        }

        .sidebar-section {
            margin-bottom: 24px;
        }

        .sidebar-section-title {
            font-size: 0.75em;
            font-weight: 600;
            color: var(--text-tertiary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            padding: 0 12px;
            margin-bottom: 8px;
        }

        .sidebar-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.2s;
            color: var(--text-secondary);
            font-size: 0.95em;
        }

        .sidebar-item:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }

        .sidebar-item.active {
            background: var(--accent-light);
            color: var(--accent-primary);
            font-weight: 500;
        }

        .sidebar-item i {
            width: 20px;
            text-align: center;
        }

        .sidebar-footer {
            margin-top: auto;
            padding-top: 16px;
            border-top: 1px solid var(--border-color);
        }

        /* ä¸»å†…å®¹åŒº */
        .main {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: var(--bg-primary);
        }

        /* é¡¶éƒ¨å·¥å…·æ  */
        .toolbar {
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            padding: 12px 24px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .toolbar-select {
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background: var(--bg-tertiary);
            color: var(--text-primary);
            font-size: 0.9em;
            cursor: pointer;
            transition: all 0.2s;
        }

        .toolbar-select:hover {
            border-color: var(--accent-primary);
            background: var(--bg-hover);
        }

        .toolbar-button {
            padding: 8px 16px;
            border: none;
            border-radius: 8px;
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            font-size: 0.9em;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .toolbar-button:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }

        /* å¯¹è¯åŒºåŸŸ */
        .chat-container {
            flex: 1;
            overflow-y: auto;
            padding: 40px 24px;
        }

        .chat-container::-webkit-scrollbar {
            width: 8px;
        }

        .chat-container::-webkit-scrollbar-track {
            background: transparent;
        }

        .chat-container::-webkit-scrollbar-thumb {
            background: var(--bg-hover);
            border-radius: 4px;
        }

        .chat-container::-webkit-scrollbar-thumb:hover {
            background: var(--border-color);
        }

        .chat-messages {
            max-width: 800px;
            margin: 0 auto;
        }

        .message {
            margin-bottom: 32px;
        }

        .message-user {
            display: flex;
            justify-content: flex-end;
        }

        .message-bubble {
            background: var(--bg-secondary);
            color: var(--text-primary);
            padding: 12px 20px;
            border-radius: 20px;
            max-width: 80%;
            font-size: 0.95em;
            line-height: 1.5;
            border: 1px solid var(--border-color);
        }

        .message-assistant {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .message-text {
            color: var(--text-secondary);
            font-size: 0.95em;
            line-height: 1.6;
        }

        .message-image {
            display: inline-block;
            max-width: 280px;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }

        .message-image:hover {
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
            transform: scale(1.02);
        }

        .message-image::after {
            content: 'ç‚¹å‡»æŸ¥çœ‹åŸå›¾';
            position: absolute;
            bottom: 8px;
            right: 8px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.75em;
            opacity: 0;
            transition: opacity 0.2s;
            pointer-events: none;
        }

        .message-image:hover::after {
            opacity: 1;
        }

        .message-image img {
            width: 100%;
            height: auto;
            display: block;
        }

        /* å›¾ç‰‡æŸ¥çœ‹å™¨æ¨¡æ€æ¡† */
        .image-viewer-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.9);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .image-viewer-modal.active {
            display: flex;
        }

        .image-viewer-content {
            max-width: 90vw;
            max-height: 90vh;
            position: relative;
        }

        .image-viewer-content img {
            max-width: 100%;
            max-height: 90vh;
            object-fit: contain;
            border-radius: 8px;
        }

        .image-viewer-close {
            position: absolute;
            top: -40px;
            right: 0;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.5em;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .image-viewer-close:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .message-actions {
            display: flex;
            gap: 8px;
            margin-top: 8px;
        }

        .action-button {
            padding: 6px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            font-size: 0.85em;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .action-button:hover {
            background: var(--bg-hover);
            border-color: var(--accent-primary);
            color: var(--text-primary);
        }

        /* åº•éƒ¨è¾“å…¥åŒº */
        .input-container {
            padding: 20px 24px;
        }

        .input-wrapper {
            max-width: 800px;
            margin: 0 auto;
            position: relative;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            transition: all 0.2s;
        }

        .input-wrapper:focus-within {
            background: var(--bg-hover);
            border-color: var(--accent-primary);
        }

        .input-box {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 16px 8px 16px;
            background: transparent;
            border: none;
            margin-bottom: 0;
        }

        .input-textarea {
            flex: 1;
            border: none;
            background: transparent;
            resize: none;
            font-size: 0.95em;
            font-family: inherit;
            color: var(--text-primary);
            outline: none;
            max-height: 200px;
            line-height: 1.4;
            padding: 0;
        }

        .input-textarea::placeholder {
            color: var(--text-tertiary);
        }

        .input-toolbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 16px 12px 16px;
        }

        .toolbar-left {
            display: flex;
            gap: 4px;
            align-items: center;
        }

        .toolbar-right {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .tool-icon-button {
            width: 32px;
            height: 32px;
            border: none;
            background: transparent;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            color: var(--text-tertiary);
            font-size: 0.9em;
        }

        .tool-icon-button:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }

        .input-actions {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .icon-button {
            width: 32px;
            height: 32px;
            border: none;
            background: transparent;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            color: var(--text-tertiary);
        }

        .icon-button:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }

        .send-button {
            width: 32px;
            height: 32px;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            font-size: 0.9em;
        }

        .send-button:hover {
            background: var(--bg-hover);
            color: var(--accent-primary);
        }

        .send-button:disabled {
            color: var(--text-tertiary);
            cursor: not-allowed;
        }

        /* åŠ è½½åŠ¨ç”» */
        .loading {
            display: flex;
            gap: 4px;
            padding: 12px 0;
        }

        .loading-dot {
            width: 8px;
            height: 8px;
            background: var(--accent-primary);
            border-radius: 50%;
            animation: bounce 1.4s infinite ease-in-out both;
        }

        .loading-dot:nth-child(1) {
            animation-delay: -0.32s;
        }

        .loading-dot:nth-child(2) {
            animation-delay: -0.16s;
        }

        @keyframes bounce {
            0%, 80%, 100% {
                transform: scale(0);
            }
            40% {
                transform: scale(1);
            }
        }

        /* æ¨¡æ€æ¡† */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--bg-secondary);
            border-radius: 16px;
            padding: 32px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            border: 1px solid var(--border-color);
        }

        .modal-header {
            font-size: 1.3em;
            font-weight: 600;
            margin-bottom: 24px;
            color: var(--text-primary);
        }

        .modal-footer {
            display: flex;
            gap: 12px;
            margin-top: 24px;
            justify-content: flex-end;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 0.95em;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-primary {
            background: var(--accent-primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--accent-hover);
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }

        /* èœå•åˆ‡æ¢æŒ‰é’® */
        .menu-toggle {
            display: none;
            width: 36px;
            height: 36px;
            border: none;
            background: transparent;
            font-size: 1.2em;
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.2s;
            color: var(--text-secondary);
        }

        .menu-toggle:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }

        /* é®ç½©å±‚ */
        .sidebar-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 99;
        }

        .sidebar-overlay.active {
            display: block;
        }

        /* å“åº”å¼ */
        @media (max-width: 768px) {
            .sidebar {
                position: fixed;
                left: -260px;
                top: 0;
                bottom: 0;
                z-index: 100;
                transition: left 0.3s ease;
                box-shadow: 2px 0 8px rgba(0, 0, 0, 0.1);
            }

            .sidebar.open {
                left: 0;
            }

            .menu-toggle {
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .toolbar {
                padding: 12px 16px;
            }

            .toolbar-select {
                font-size: 0.85em;
                padding: 6px 10px;
            }

            .toolbar-button {
                font-size: 0.85em;
                padding: 6px 12px;
            }

            .chat-container {
                padding: 20px 16px;
            }

            .chat-messages {
                max-width: 100%;
            }

            .message-bubble {
                max-width: 85%;
                font-size: 0.9em;
            }

            .message-image {
                max-width: 50%;
            }

            .input-container {
                padding: 16px;
            }

            .input-wrapper {
                border-radius: 6px;
            }

            .input-box {
                padding: 12px 14px 6px 14px;
            }

            .input-textarea {
                font-size: 0.9em;
            }

            .input-toolbar {
                padding: 6px 14px 10px 14px;
            }

            .tool-icon-button {
                width: 30px;
                height: 30px;
                font-size: 0.85em;
            }

            .send-button {
                width: 30px;
                height: 30px;
                font-size: 0.85em;
            }
        }

        @media (max-width: 480px) {
            .toolbar {
                flex-wrap: wrap;
                gap: 8px;
            }

            .toolbar-select {
                flex: 1;
                min-width: 0;
            }

            .message-bubble {
                max-width: 90%;
                padding: 10px 16px;
            }

            .action-button {
                font-size: 0.8em;
                padding: 5px 10px;
            }

            .message-image {
                max-width: 65%;
            }
        }

        /* æ¡Œé¢ç«¯æ˜¾ç¤ºå†å²è®°å½•é¢„è§ˆå›¾ */
        @media (min-width: 769px) {
            .history-preview-img {
                display: block !important;
            }
        }

        /* å¯¹è¯åˆ—è¡¨æ»šåŠ¨æ¡æ ·å¼ */
        #conversationListSection::-webkit-scrollbar,
        #conversationList::-webkit-scrollbar {
            width: 6px;
        }

        #conversationListSection::-webkit-scrollbar-track,
        #conversationList::-webkit-scrollbar-track {
            background: transparent;
        }

        #conversationListSection::-webkit-scrollbar-thumb,
        #conversationList::-webkit-scrollbar-thumb {
            background: var(--bg-hover);
            border-radius: 3px;
        }

        #conversationListSection::-webkit-scrollbar-thumb:hover,
        #conversationList::-webkit-scrollbar-thumb:hover {
            background: var(--border-color);
        }
    </style>
<base target="_blank">
</head>
<body>
    <div class="app">
        <!-- é®ç½©å±‚ -->
        <div class="sidebar-overlay" id="sidebarOverlay" onclick="closeSidebar()"></div>

        <!-- ä¾§è¾¹æ  -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <i class="fas fa-palette" style="color: var(--accent-primary);"></i>
                <h1>AI å›¾ç‰‡ç”Ÿæˆ</h1>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-section-title">èœå•</div>
                <div class="sidebar-item" onclick="createNewConversation()">
                    <i class="fas fa-plus"></i>
                    <span>æ–°å»ºå¯¹è¯</span>
                </div>
                <div class="sidebar-item active" onclick="switchView('chat')">
                    <i class="fas fa-home"></i>
                    <span>ä¸»é¡µ</span>
                </div>
                <div class="sidebar-item" onclick="switchView('history')">
                    <i class="fas fa-history"></i>
                    <span>å†å²è®°å½•</span>
                </div>
                <div class="sidebar-item" onclick="showSettings()">
                    <i class="fas fa-cog"></i>
                    <span>è®¾ç½®</span>
                </div>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-section-title">å·¥å…·</div>
                <div class="sidebar-item" onclick="showThemeModal()">
                    <i class="fas fa-palette"></i>
                    <span id="themeMenuText">ä¸»é¢˜è®¾ç½®</span>
                </div>
            </div>

            <div class="sidebar-footer">
                <div class="sidebar-item">
                    <i class="fas fa-user"></i>
                    <span>ç”¨æˆ·</span>
                </div>
            </div>
        </div>

        <!-- ä¸»å†…å®¹åŒº -->
        <div class="main">
            <!-- é¡¶éƒ¨å·¥å…·æ  -->
            <div class="toolbar">
                <button class="menu-toggle" onclick="toggleSidebar()">
                    <i class="fas fa-bars"></i>
                </button>
                <select class="toolbar-select" id="modelSelect">
                    <option>gemini-2.5-flash-image</option>
                    <option>gemini-2.0-flash-exp-image-generation</option>
                </select>
                <button class="toolbar-button" onclick="showSettings()">
                    <i class="fas fa-cog"></i>
                    <span>é…ç½®</span>
                </button>
            </div>

            <!-- å¯¹è¯åŒºåŸŸ -->
            <div class="chat-container" id="chatContainer">
                <div class="chat-messages" id="chatMessages">
                    <!-- æ¬¢è¿æ¶ˆæ¯ -->
                    <div class="message message-assistant">
                        <div class="message-text">
                            <i class="fas fa-robot" style="margin-right: 6px; color: var(--accent-primary);"></i>
                            ä½ å¥½ï¼æˆ‘æ˜¯ AI å›¾ç‰‡ç”ŸæˆåŠ©æ‰‹ã€‚<br>
                            è¯·æè¿°ä½ æƒ³è¦ç”Ÿæˆçš„å›¾ç‰‡ï¼Œæˆ–ä¸Šä¼ å‚è€ƒå›¾ç‰‡è¿›è¡Œç¼–è¾‘ã€‚
                        </div>
                    </div>
                </div>
            </div>

            <!-- åº•éƒ¨è¾“å…¥åŒº -->
            <div class="input-container">
                <div class="input-wrapper">
                    <div class="input-box">
                        <textarea
                            class="input-textarea"
                            id="promptInput"
                            placeholder="æè¿°ä½ æƒ³è¦çš„å›¾ç‰‡..."
                            rows="1"
                            onkeydown="handleKeyDown(event)"
                        ></textarea>
                    </div>
                    <div class="input-toolbar">
                        <div class="toolbar-left">
                            <button class="tool-icon-button" onclick="uploadImage()" title="ä¸Šä¼ å›¾ç‰‡">
                                <i class="fas fa-camera"></i>
                            </button>
                            <button class="tool-icon-button" onclick="showBlankImageModal()" title="ç”Ÿæˆç©ºç™½å›¾">
                                <i class="fas fa-palette"></i>
                            </button>
                            <button class="tool-icon-button" title="æ›´å¤šåŠŸèƒ½">
                                <i class="fas fa-ellipsis-h"></i>
                            </button>
                        </div>
                        <div class="toolbar-right">
                            <button class="send-button" id="sendButton" onclick="sendMessage()">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- è®¾ç½®æ¨¡æ€æ¡† -->
    <div class="modal" id="settingsModal">
        <div class="modal-content">
            <div class="modal-header">
                <i class="fas fa-cog" style="margin-right: 8px; color: var(--accent-primary);"></i>
                API é…ç½®
            </div>

            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--text-primary);">API åœ°å€</label>
                <input type="text" id="apiUrl" value="https://privnode.com/v1/chat/completions"
                    style="width: 100%; padding: 10px 12px; border: 1px solid var(--border-color); border-radius: 8px; font-size: 0.95em; background: var(--bg-tertiary); color: var(--text-primary);">
            </div>

            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--text-primary);">API å¯†é’¥</label>
                <input type="password" id="apiKey" placeholder="è¾“å…¥ä½ çš„ API Key"
                    style="width: 100%; padding: 10px 12px; border: 1px solid var(--border-color); border-radius: 8px; font-size: 0.95em; background: var(--bg-tertiary); color: var(--text-primary);">
            </div>

            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeSettings()">å–æ¶ˆ</button>
                <button class="btn btn-primary" onclick="saveSettings()">ä¿å­˜</button>
            </div>
        </div>
    </div>

    <input type="file" id="imageUpload" accept="image/*" multiple style="display: none;" onchange="handleImageUpload(event)">

    <!-- ç©ºç™½å›¾ç‰‡ç”Ÿæˆæ¨¡æ€æ¡† -->
    <div class="modal" id="blankImageModal">
        <div class="modal-content">
            <div class="modal-header">
                <i class="fas fa-palette" style="margin-right: 8px; color: var(--accent-primary);"></i>
                ç”Ÿæˆç©ºç™½å›¾ç‰‡
            </div>

            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 10px; font-weight: 500; color: var(--text-primary);">é€‰æ‹©å›¾ç‰‡æ¯”ä¾‹ï¼š</label>
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">
                    <button class="ratio-option" data-ratio="9:16" onclick="selectBlankRatio('9:16', this)">
                        <div style="font-size: 1.2em; font-weight: 600;">9:16</div>
                        <div style="font-size: 0.85em; color: #666;">ç«–å± (768x1365)</div>
                    </button>
                    <button class="ratio-option" data-ratio="16:9" onclick="selectBlankRatio('16:9', this)">
                        <div style="font-size: 1.2em; font-weight: 600;">16:9</div>
                        <div style="font-size: 0.85em; color: #666;">æ¨ªå± (1344x768)</div>
                    </button>
                    <button class="ratio-option" data-ratio="1:1" onclick="selectBlankRatio('1:1', this)">
                        <div style="font-size: 1.2em; font-weight: 600;">1:1</div>
                        <div style="font-size: 0.85em; color: #666;">æ­£æ–¹å½¢ (1024x1024)</div>
                    </button>
                    <button class="ratio-option" data-ratio="4:3" onclick="selectBlankRatio('4:3', this)">
                        <div style="font-size: 1.2em; font-weight: 600;">4:3</div>
                        <div style="font-size: 0.85em; color: #666;">æ ‡å‡† (1344x1008)</div>
                    </button>
                </div>
            </div>

            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 10px; font-weight: 500; color: var(--text-primary);">èƒŒæ™¯é¢œè‰²ï¼š</label>
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px;">
                    <button class="color-option" data-color="#FFFFFF" onclick="selectBlankColor('#FFFFFF', this)" style="background: #FFFFFF; border: 2px solid var(--border-color); color: #000;">ç™½è‰²</button>
                    <button class="color-option" data-color="#000000" onclick="selectBlankColor('#000000', this)" style="background: #000000; color: white;">é»‘è‰²</button>
                    <button class="color-option" data-color="#F5F5F5" onclick="selectBlankColor('#F5F5F5', this)" style="background: #F5F5F5; color: #000;">ç°è‰²</button>
                    <button class="color-option" data-color="#E8F4F8" onclick="selectBlankColor('#E8F4F8', this)" style="background: #E8F4F8; color: #000;">æµ…è“</button>
                </div>
            </div>

            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeBlankImageModal()">å–æ¶ˆ</button>
                <button class="btn btn-primary" onclick="generateBlankImage()">ç”Ÿæˆå¹¶ä½¿ç”¨</button>
            </div>
        </div>
    </div>

    <!-- ä¸»é¢˜è®¾ç½®æ¨¡æ€æ¡† -->
    <div class="modal" id="themeModal">
        <div class="modal-content">
            <div class="modal-header">
                <i class="fas fa-palette" style="margin-right: 8px; color: var(--accent-primary);"></i>
                ä¸»é¢˜è®¾ç½®
            </div>

            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 10px; font-weight: 500; color: var(--text-primary);">é€‰æ‹©ä¸»é¢˜æ¨¡å¼ï¼š</label>
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;">
                    <button class="theme-option" data-theme="light" onclick="selectTheme('light', this)">
                        <div style="font-size: 2em; margin-bottom: 8px;">â˜€ï¸</div>
                        <div style="font-size: 0.95em; font-weight: 500;">æµ…è‰²æ¨¡å¼</div>
                        <div style="font-size: 0.8em; color: var(--text-tertiary); margin-top: 4px;">æ˜äº®æ¸…æ–°</div>
                    </button>
                    <button class="theme-option" data-theme="dark" onclick="selectTheme('dark', this)">
                        <div style="font-size: 2em; margin-bottom: 8px;">ğŸŒ™</div>
                        <div style="font-size: 0.95em; font-weight: 500;">æ·±è‰²æ¨¡å¼</div>
                        <div style="font-size: 0.8em; color: var(--text-tertiary); margin-top: 4px;">æŠ¤çœ¼èˆ’é€‚</div>
                    </button>
                    <button class="theme-option" data-theme="auto" onclick="selectTheme('auto', this)">
                        <div style="font-size: 2em; margin-bottom: 8px;">ğŸ”„</div>
                        <div style="font-size: 0.95em; font-weight: 500;">è·Ÿéšç³»ç»Ÿ</div>
                        <div style="font-size: 0.8em; color: var(--text-tertiary); margin-top: 4px;">è‡ªåŠ¨åˆ‡æ¢</div>
                    </button>
                </div>
            </div>

            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeThemeModal()">å–æ¶ˆ</button>
                <button class="btn btn-primary" onclick="applyTheme()">åº”ç”¨</button>
            </div>
        </div>
    </div>

    <style>
        .theme-option {
            padding: 16px 12px;
            border: 2px solid var(--border-color);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
            background: var(--bg-tertiary);
            text-align: center;
            color: var(--text-primary);
        }

        .theme-option:hover {
            border-color: var(--accent-primary);
            background: var(--bg-hover);
            transform: translateY(-2px);
        }

        .theme-option.active {
            background: var(--accent-primary);
            color: white;
            border-color: var(--accent-primary);
        }

        .theme-option.active div {
            color: white !important;
        }
    </style>

    <style>
        .ratio-option, .color-option {
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            background: var(--bg-tertiary);
            text-align: center;
            color: var(--text-primary);
        }

        .ratio-option:hover, .color-option:hover {
            border-color: var(--accent-primary);
            background: var(--bg-hover);
        }

        .ratio-option.active, .color-option.active {
            background: var(--accent-primary);
            color: white;
            border-color: var(--accent-primary);
        }

        .ratio-option.active div {
            color: white !important;
        }
    </style>

    <script>
        let uploadedImage = null;
        let uploadedImages = []; // æ”¯æŒå¤šå›¾ä¸Šä¼ 
        let conversationHistory = [];
        let imageHistory = [];
        let conversations = []; // æ‰€æœ‰å¯¹è¯åˆ—è¡¨
        let currentConversationId = null; // å½“å‰å¯¹è¯ID
        let db = null;
        let currentView = 'chat';
        let selectedBlankRatio = '9:16';
        let selectedBlankColor = '#FFFFFF';
        let lastPrompt = ''; // ä¿å­˜ä¸Šä¸€æ¬¡çš„æç¤ºè¯
        let lastUploadedImages = []; // ä¿å­˜ä¸Šä¸€æ¬¡çš„å›¾ç‰‡
        let currentTheme = 'dark'; // å½“å‰ä¸»é¢˜ï¼šlight, dark, auto
        let selectedTheme = 'dark'; // ç”¨æˆ·é€‰æ‹©çš„ä¸»é¢˜

        const DB_NAME = 'AIImageGeneratorDB';
        const DB_VERSION = 2; // å‡çº§ç‰ˆæœ¬ä»¥æ·»åŠ æ–°çš„å­˜å‚¨
        const STORE_NAME = 'imageHistory';
        const CONVERSATION_STORE = 'conversations'; // æ–°å¢å¯¹è¯å­˜å‚¨

        // ========== ä¸»é¢˜ç®¡ç†åŠŸèƒ½ ==========

        // åˆå§‹åŒ–ä¸»é¢˜
        function initTheme() {
            const savedTheme = localStorage.getItem('appTheme') || 'dark';
            currentTheme = savedTheme;
            selectedTheme = savedTheme;
            applyThemeInternal(savedTheme);
        }

        // åº”ç”¨ä¸»é¢˜ï¼ˆå†…éƒ¨å‡½æ•°ï¼‰
        function applyThemeInternal(theme) {
            const html = document.documentElement;

            if (theme === 'auto') {
                // è·Ÿéšç³»ç»Ÿ
                const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                html.setAttribute('data-theme', prefersDark ? 'dark' : 'light');
            } else if (theme === 'light') {
                html.setAttribute('data-theme', 'light');
            } else {
                // dark
                html.removeAttribute('data-theme');
            }

            currentTheme = theme;
        }

        // æ˜¾ç¤ºä¸»é¢˜æ¨¡æ€æ¡†
        function showThemeModal() {
            document.getElementById('themeModal').classList.add('active');

            // è®¾ç½®å½“å‰é€‰ä¸­çš„ä¸»é¢˜
            document.querySelectorAll('.theme-option').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.theme === selectedTheme) {
                    btn.classList.add('active');
                }
            });
        }

        // å…³é—­ä¸»é¢˜æ¨¡æ€æ¡†
        function closeThemeModal() {
            document.getElementById('themeModal').classList.remove('active');
        }

        // é€‰æ‹©ä¸»é¢˜
        function selectTheme(theme, element) {
            selectedTheme = theme;
            document.querySelectorAll('.theme-option').forEach(btn => btn.classList.remove('active'));
            element.classList.add('active');
        }

        // åº”ç”¨ä¸»é¢˜
        function applyTheme() {
            applyThemeInternal(selectedTheme);
            localStorage.setItem('appTheme', selectedTheme);
            closeThemeModal();

            const themeNames = {
                'light': 'æµ…è‰²æ¨¡å¼',
                'dark': 'æ·±è‰²æ¨¡å¼',
                'auto': 'è·Ÿéšç³»ç»Ÿ'
            };
            addSystemMessage(`<i class="fas fa-check-circle" style="color: var(--success); margin-right: 4px;"></i> å·²åˆ‡æ¢åˆ°${themeNames[selectedTheme]}`);
        }

        // ç›‘å¬ç³»ç»Ÿä¸»é¢˜å˜åŒ–
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
            if (currentTheme === 'auto') {
                applyThemeInternal('auto');
            }
        });

        // åˆå§‹åŒ– IndexedDB
        async function initDB() {
            return new Promise((resolve, reject) => {
                const request = indexedDB.open(DB_NAME, DB_VERSION);

                request.onerror = () => {
                    console.error('IndexedDB æ‰“å¼€å¤±è´¥:', request.error);
                    reject(request.error);
                };

                request.onsuccess = () => {
                    db = request.result;
                    console.log('IndexedDB åˆå§‹åŒ–æˆåŠŸ');
                    resolve(db);
                };

                request.onupgradeneeded = (event) => {
                    db = event.target.result;

                    // å›¾ç‰‡å†å²å­˜å‚¨
                    if (!db.objectStoreNames.contains(STORE_NAME)) {
                        const objectStore = db.createObjectStore(STORE_NAME, { keyPath: 'id', autoIncrement: true });
                        objectStore.createIndex('timestamp', 'timestamp', { unique: false });
                    }

                    // å¯¹è¯å†å²å­˜å‚¨
                    if (!db.objectStoreNames.contains(CONVERSATION_STORE)) {
                        const convStore = db.createObjectStore(CONVERSATION_STORE, { keyPath: 'id', autoIncrement: true });
                        convStore.createIndex('timestamp', 'timestamp', { unique: false });
                        convStore.createIndex('lastUpdated', 'lastUpdated', { unique: false });
                    }
                };
            });
        }

        // é¡µé¢åŠ è½½æ—¶è¯»å–é…ç½®
        window.addEventListener('DOMContentLoaded', async () => {
            initTheme(); // åˆå§‹åŒ–ä¸»é¢˜
            loadConfig();
            autoResizeTextarea();
            await initDB();
            await loadHistory();
            await loadConversations();
            await createOrLoadConversation();
        });

        // é¡µé¢éšè—æ—¶ä¿å­˜å¯¹è¯ï¼ˆæ›´å¯é ï¼‰
        document.addEventListener('visibilitychange', async () => {
            if (document.hidden && currentConversationId && conversationHistory.length > 0) {
                await saveCurrentConversation();
            }
        });

        // é¡µé¢å…³é—­å‰ä¿å­˜å¯¹è¯
        window.addEventListener('beforeunload', async (e) => {
            if (currentConversationId && conversationHistory.length > 0) {
                await saveCurrentConversation();
            }
        });

        // å®šæœŸè‡ªåŠ¨ä¿å­˜ï¼ˆæ¯30ç§’ï¼Œä¸æ›´æ–°åˆ—è¡¨UIï¼‰
        setInterval(async () => {
            if (currentConversationId && conversationHistory.length > 0) {
                // ç›´æ¥ä¿å­˜ï¼Œä¸è§¦å‘UIæ›´æ–°
                await saveCurrentConversation(false);
            }
        }, 30000); // æ”¹ä¸º30ç§’

        // è‡ªåŠ¨è°ƒæ•´è¾“å…¥æ¡†é«˜åº¦
        function autoResizeTextarea() {
            const textarea = document.getElementById('promptInput');
            textarea.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = Math.min(this.scrollHeight, 200) + 'px';
            });
        }

        // å¤„ç†é”®ç›˜äº‹ä»¶
        function handleKeyDown(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendMessage();
            }
        }

        // åŠ è½½é…ç½®
        function loadConfig() {
            const saved = localStorage.getItem('aiImageGenConfig');
            if (saved) {
                try {
                    const config = JSON.parse(saved);
                    document.getElementById('apiUrl').value = config.apiUrl || '';
                    document.getElementById('apiKey').value = config.apiKey || '';
                } catch (e) {
                    console.error('åŠ è½½é…ç½®å¤±è´¥:', e);
                }
            }
        }

        // ä¿å­˜é…ç½®
        function saveSettings() {
            const config = {
                apiUrl: document.getElementById('apiUrl').value,
                apiKey: document.getElementById('apiKey').value
            };
            localStorage.setItem('aiImageGenConfig', JSON.stringify(config));
            closeSettings();
            addSystemMessage('<i class="fas fa-check-circle" style="color: var(--success); margin-right: 4px;"></i> é…ç½®å·²ä¿å­˜');
        }

        // æ˜¾ç¤º/å…³é—­è®¾ç½®
        function showSettings() {
            document.getElementById('settingsModal').classList.add('active');
        }

        function closeSettings() {
            document.getElementById('settingsModal').classList.remove('active');
        }

        // ä¸Šä¼ å›¾ç‰‡
        function uploadImage() {
            document.getElementById('imageUpload').click();
        }

        // å‘é€æ¶ˆæ¯
        async function sendMessage() {
            const promptInput = document.getElementById('promptInput');
            const prompt = promptInput.value.trim();

            if (!prompt) return;

            // ä¿å­˜æœ¬æ¬¡è¯·æ±‚ä¿¡æ¯ï¼ˆç”¨äºé‡è¯•ï¼‰
            lastPrompt = prompt;
            lastUploadedImages = uploadedImages.length > 0 ? [...uploadedImages] : [];

            // æ·»åŠ ç”¨æˆ·æ¶ˆæ¯ï¼ˆåŒæ—¶ä¿å­˜å½“å‰ä½¿ç”¨çš„å›¾ç‰‡ï¼‰
            addUserMessage(prompt, [...uploadedImages]);
            promptInput.value = '';
            promptInput.style.height = 'auto';

            // æ³¨æ„ï¼šå›¾ç‰‡ç¼©ç•¥å›¾å·²ç»åœ¨ä¸Šä¼ æ—¶æ˜¾ç¤ºï¼Œè¿™é‡Œä¸å†é‡å¤æ˜¾ç¤º

            // æ˜¾ç¤ºåŠ è½½åŠ¨ç”»
            const loadingId = addLoadingMessage();

            try {
                const apiUrl = document.getElementById('apiUrl').value;
                const apiKey = document.getElementById('apiKey').value;
                const modelName = document.getElementById('modelSelect').value;

                if (!apiUrl || !apiKey) {
                    throw new Error('è¯·å…ˆé…ç½® API ä¿¡æ¯');
                }

                // æ„å»ºè¯·æ±‚
                const content = [{ type: "text", text: prompt }];

                // æ·»åŠ æ‰€æœ‰ä¸Šä¼ çš„å›¾ç‰‡
                if (uploadedImages.length > 0) {
                    uploadedImages.forEach(img => {
                        content.push({
                            type: "image_url",
                            image_url: { url: img.base64 }
                        });
                    });
                } else if (uploadedImage) {
                    content.push({
                        type: "image_url",
                        image_url: { url: uploadedImage }
                    });
                }

                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${apiKey}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        stream: true,
                        max_tokens: 8192,
                        model: modelName,
                        messages: [{ role: "user", content: content }]
                    })
                });

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}`);
                }

                // å¤„ç†æµå¼å“åº”
                await handleStreamResponse(response, loadingId);

                // æ¸…é™¤ä¸Šä¼ çš„å›¾ç‰‡ï¼ˆæ¯æ¬¡ç”Ÿæˆåæ¸…ç©ºï¼Œä¸å¸¦ä¸Šä¸€æ¬¡çš„å†…å®¹ï¼‰
                uploadedImage = null;
                uploadedImages = [];

                // è‡ªåŠ¨ä¿å­˜å½“å‰å¯¹è¯
                await saveCurrentConversation();

            } catch (error) {
                removeMessage(loadingId);
                addErrorMessageWithRetry(error.message);
                // å³ä½¿å‡ºé”™ä¹Ÿä¿å­˜å¯¹è¯
                await saveCurrentConversation();
            }
        }

        // é‡è¯•ä¸Šä¸€æ¬¡çš„è¯·æ±‚
        async function retryLastRequest() {
            if (!lastPrompt) {
                addSystemMessage('<i class="fas fa-exclamation-circle" style="color: var(--danger); margin-right: 4px;"></i> æ²¡æœ‰å¯é‡è¯•çš„è¯·æ±‚');
                return;
            }

            // æ¢å¤ä¸Šä¸€æ¬¡çš„å›¾ç‰‡
            uploadedImages = lastUploadedImages.length > 0 ? [...lastUploadedImages] : [];
            if (uploadedImages.length > 0) {
                uploadedImage = uploadedImages[0].base64;
                // æ˜¾ç¤ºå›¾ç‰‡é¢„è§ˆï¼Œè®©ç”¨æˆ·çŸ¥é“å·²ç»æ¢å¤äº†å›¾ç‰‡
                addImagePreviewMessage(uploadedImages);
            }

            // æ¢å¤æç¤ºè¯åˆ°è¾“å…¥æ¡†
            const promptInput = document.getElementById('promptInput');
            promptInput.value = lastPrompt;

            // è‡ªåŠ¨è°ƒæ•´è¾“å…¥æ¡†é«˜åº¦
            promptInput.style.height = 'auto';
            promptInput.style.height = Math.min(promptInput.scrollHeight, 200) + 'px';

            promptInput.focus();

            // è‡ªåŠ¨å‘é€
            await sendMessage();
        }

        // å¤„ç†æµå¼å“åº”
        async function handleStreamResponse(response, loadingId) {
            const reader = response.body.getReader();
            const decoder = new TextDecoder();
            let fullText = '';
            let displayText = '';
            let chunks = [];
            let buffer = '';

            try {
                while (true) {
                    const { done, value } = await reader.read();
                    if (done) break;

                    const chunk = decoder.decode(value, { stream: true });
                    fullText += chunk;
                    buffer += chunk;

                    // å¤„ç†å®Œæ•´çš„è¡Œ
                    const lines = buffer.split('\n');
                    buffer = lines.pop() || '';

                    for (const line of lines) {
                        if (line.startsWith('data: ')) {
                            const data = line.slice(6).trim();
                            if (data === '[DONE]') continue;

                            try {
                                const json = JSON.parse(data);
                                chunks.push(json);
                                const content = json.choices?.[0]?.delta?.content || '';
                                if (content) {
                                    displayText += content;
                                }
                            } catch (e) {
                                console.warn('JSON è§£æå¤±è´¥:', e);
                            }
                        }
                    }
                }

                // å¤„ç†å‰©ä½™æ•°æ®
                if (buffer.trim() && buffer.startsWith('data: ')) {
                    const data = buffer.slice(6).trim();
                    if (data !== '[DONE]') {
                        try {
                            const json = JSON.parse(data);
                            chunks.push(json);
                            const content = json.choices?.[0]?.delta?.content || '';
                            if (content) displayText += content;
                        } catch (e) {
                            console.warn('æœ€åæ•°æ®è§£æå¤±è´¥:', e);
                        }
                    }
                }
            } catch (error) {
                console.error('æµå¼è¯»å–é”™è¯¯:', error);
                removeMessage(loadingId);
                addSystemMessage('<i class="fas fa-exclamation-triangle" style="color: var(--danger); margin-right: 4px;"></i> æµå¼è¯»å–å¤±è´¥: ' + error.message);
                return;
            }

            // ç§»é™¤åŠ è½½åŠ¨ç”»
            removeMessage(loadingId);

            // å…ˆä» displayText æå–ï¼Œå†ä» fullText æå–
            let imageUrl = extractImageFromText(displayText);
            if (!imageUrl) {
                imageUrl = extractImageFromText(fullText);
            }

            if (imageUrl) {
                // è·å–æç¤ºè¯
                const promptInput = document.getElementById('promptInput');
                const prompt = promptInput ? promptInput.value.trim() : '';

                // ä¿å­˜åˆ°å†å²è®°å½•
                const img = new Image();
                img.onload = async function() {
                    const dimensions = `${img.width}Ã—${img.height}`;
                    await saveToHistory(imageUrl, prompt, dimensions);
                };
                img.src = imageUrl;

                addAssistantMessage(imageUrl, fullText);
            } else {
                console.error('æœªæ‰¾åˆ°å›¾ç‰‡æ•°æ®');
                addErrorMessageWithRetry('æœªæ‰¾åˆ°å›¾ç‰‡æ•°æ®ï¼Œå¯èƒ½æ˜¯æ¨¡å‹è¿”å›æ ¼å¼å¼‚å¸¸ï¼Œè¯·é‡è¯•');
            }
        }

        // ä»æ–‡æœ¬ä¸­æå–å›¾ç‰‡
        function extractImageFromText(text) {
            if (!text) return null;

            // æ–¹æ³•1: Markdown æ ¼å¼ ![image](data:image/png;base64,...)
            const markdownMatch = text.match(/!\[.*?\]\((data:image\/[^)]+)\)/);
            if (markdownMatch) {
                return markdownMatch[1];
            }

            // æ–¹æ³•2: ç›´æ¥æŸ¥æ‰¾ data:image/ å¼€å¤´çš„å®Œæ•´ base64
            const dataImageIndex = text.indexOf('data:image/');
            if (dataImageIndex !== -1) {
                // ä» data:image å¼€å§‹ï¼Œæå–åˆ°ç¬¬ä¸€ä¸ªç©ºç™½å­—ç¬¦ã€å¼•å·æˆ–æ‹¬å·
                const remaining = text.substring(dataImageIndex);
                // åŒ¹é… data:image/ç±»å‹;base64,æ•°æ® ç›´åˆ°é‡åˆ°ç©ºç™½ã€å¼•å·ã€æ¢è¡Œç­‰
                const endMatch = remaining.match(/^data:image\/[a-zA-Z]+;base64,[A-Za-z0-9+/=]+/);
                if (endMatch) {
                    return endMatch[0];
                }
            }

            return null;
        }

        // æ·»åŠ æ¶ˆæ¯åˆ°å¯¹è¯
        function addUserMessage(text, images = []) {
            const messagesContainer = document.getElementById('chatMessages');
            if (!messagesContainer) {
                console.warn('èŠå¤©å®¹å™¨ä¸å­˜åœ¨ï¼Œåˆ‡æ¢åˆ°èŠå¤©è§†å›¾');
                switchView('chat');
                setTimeout(() => addUserMessage(text, images), 100);
                return;
            }
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message message-user';

            // è½¬ä¹‰æ–‡æœ¬ç”¨äºæ˜¾ç¤ºï¼Œä½†ä¿å­˜åŸå§‹æ–‡æœ¬ç”¨äºç¼–è¾‘
            const escapedText = escapeHtml(text);

            // ä¸ºäº†åœ¨onclickä¸­ä¼ é€’æ•°æ®ï¼Œæˆ‘ä»¬ç»™æ¶ˆæ¯ä¸€ä¸ªå”¯ä¸€ID
            const messageId = 'user-msg-' + Date.now();
            messageDiv.id = messageId;

            const html = `
                <div style="display: flex; flex-direction: column; align-items: flex-end; gap: 8px;">
                    <div class="message-bubble">${escapedText}</div>
                    <button class="action-button" onclick="editPromptWithImages('${messageId}')" style="font-size: 0.8em; padding: 4px 10px;">
                        <i class="fas fa-edit"></i> ç¼–è¾‘æç¤ºè¯
                    </button>
                </div>
            `;
            messageDiv.innerHTML = html;
            messagesContainer.appendChild(messageDiv);

            // ä¿å­˜åˆ°å¯¹è¯å†å²
            conversationHistory.push({
                type: 'user',
                html: messageDiv.outerHTML,
                text: text,  // ä¿å­˜åŸå§‹æ–‡æœ¬ç”¨äºç¼–è¾‘
                images: images,  // ä¿å­˜å›¾ç‰‡ä¿¡æ¯
                messageId: messageId  // ä¿å­˜æ¶ˆæ¯IDç”¨äºæŸ¥æ‰¾
            });

            scrollToBottom();
        }

        function addAssistantMessage(imageUrl, fullText) {
            const messagesContainer = document.getElementById('chatMessages');
            if (!messagesContainer) {
                console.warn('èŠå¤©å®¹å™¨ä¸å­˜åœ¨');
                return;
            }
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message message-assistant';
            const html = `
                <div class="message-image" onclick="viewImageInModal('${imageUrl}')">
                    <img src="${imageUrl}" alt="ç”Ÿæˆçš„å›¾ç‰‡">
                </div>
                <div class="message-actions">
                    <button class="action-button" onclick="retryLastRequest()">
                        <i class="fas fa-redo"></i> é‡æ–°ç”Ÿæˆ
                    </button>
                    <button class="action-button" onclick="downloadImage('${imageUrl}')">
                        <i class="fas fa-download"></i> ä¸‹è½½
                    </button>
                    <button class="action-button" onclick="continueEdit('${imageUrl}')">
                        <i class="fas fa-edit"></i> ç»§ç»­ç¼–è¾‘
                    </button>
                </div>
            `;
            messageDiv.innerHTML = html;
            messagesContainer.appendChild(messageDiv);

            // ä¿å­˜åˆ°å¯¹è¯å†å²
            conversationHistory.push({
                type: 'assistant',
                html: messageDiv.outerHTML,
                imageUrl: imageUrl  // ä¿å­˜å›¾ç‰‡URLç”¨äºå†å²è®°å½•
            });

            scrollToBottom();
        }

        function addSystemMessage(text) {
            // å¦‚æœåœ¨èŠå¤©è§†å›¾ï¼Œæ·»åŠ åˆ°èŠå¤©æ¶ˆæ¯
            const messagesContainer = document.getElementById('chatMessages');
            if (messagesContainer) {
                const messageDiv = document.createElement('div');
                messageDiv.className = 'message message-assistant';
                // ä¸è½¬ä¹‰HTMLï¼Œå› ä¸ºç³»ç»Ÿæ¶ˆæ¯éƒ½æ˜¯å†…éƒ¨ç”Ÿæˆçš„ï¼ŒåŒ…å«å›¾æ ‡ç­‰HTMLæ ‡ç­¾
                const html = `<div class="message-text">${text}</div>`;
                messageDiv.innerHTML = html;
                messagesContainer.appendChild(messageDiv);

                // ä¿å­˜åˆ°å¯¹è¯å†å²
                conversationHistory.push({
                    type: 'system',
                    html: messageDiv.outerHTML
                });

                scrollToBottom();
            } else {
                // å¦åˆ™ä½¿ç”¨ alertï¼ˆç§»é™¤HTMLæ ‡ç­¾ï¼‰
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = text;
                alert(tempDiv.textContent || tempDiv.innerText || text);
            }
        }

        // æ·»åŠ å›¾ç‰‡é¢„è§ˆæ¶ˆæ¯ï¼ˆæ˜¾ç¤ºç¼©ç•¥å›¾ï¼‰
        function addImagePreviewMessage(images) {
            const messagesContainer = document.getElementById('chatMessages');
            if (!messagesContainer) return;

            const messageDiv = document.createElement('div');
            messageDiv.className = 'message message-assistant';
            messageDiv.id = 'imagePreviewMessage'; // æ·»åŠ IDä»¥ä¾¿åç»­æ›´æ–°

            let imagesHtml = images.map((img, index) => `
                <div style="position: relative; display: inline-block; margin: 4px;">
                    <img src="${img.base64}"
                         style="width: 80px; height: 80px; object-fit: cover; border-radius: 8px; border: 2px solid #007aff; display: block;"
                         title="${img.name || 'å›¾ç‰‡ ' + (index + 1)}">
                    <button onclick="removeUploadedImage(${index})"
                            style="position: absolute; top: -6px; right: -6px; width: 20px; height: 20px; border-radius: 50%; background: #ef4444; color: white; border: 2px solid white; cursor: pointer; font-size: 12px; line-height: 1; padding: 0; display: flex; align-items: center; justify-content: center;"
                            title="åˆ é™¤æ­¤å›¾ç‰‡">Ã—</button>
                </div>
            `).join('');

            const html = `
                <div class="message-text" style="display: flex; align-items: center; gap: 8px; flex-wrap: wrap;">
                    <span style="color: var(--text-tertiary); font-size: 0.9em;">
                        <i class="fas fa-camera" style="margin-right: 4px;"></i>
                        å·²åŠ è½½ ${images.length} å¼ å‚è€ƒå›¾ï¼š
                    </span>
                    ${imagesHtml}
                </div>
            `;
            messageDiv.innerHTML = html;

            // ç§»é™¤æ—§çš„é¢„è§ˆæ¶ˆæ¯ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
            const oldPreview = document.getElementById('imagePreviewMessage');
            if (oldPreview) {
                oldPreview.remove();
                // åŒæ—¶ä»å¯¹è¯å†å²ä¸­ç§»é™¤
                conversationHistory = conversationHistory.filter(msg => msg.type !== 'image-preview');
            }

            messagesContainer.appendChild(messageDiv);

            // ä¿å­˜åˆ°å¯¹è¯å†å²
            conversationHistory.push({
                type: 'image-preview',
                html: messageDiv.outerHTML
            });

            scrollToBottom();
        }

        // åˆ é™¤å·²ä¸Šä¼ çš„å›¾ç‰‡
        function removeUploadedImage(index) {
            if (index >= 0 && index < uploadedImages.length) {
                uploadedImages.splice(index, 1);

                // å¦‚æœè¿˜æœ‰å›¾ç‰‡ï¼Œé‡æ–°æ˜¾ç¤ºé¢„è§ˆ
                if (uploadedImages.length > 0) {
                    addImagePreviewMessage(uploadedImages);
                    uploadedImage = uploadedImages[0].base64; // æ›´æ–°ä¸»å›¾ç‰‡
                } else {
                    // å¦‚æœæ²¡æœ‰å›¾ç‰‡äº†ï¼Œç§»é™¤é¢„è§ˆæ¶ˆæ¯
                    const previewMsg = document.getElementById('imagePreviewMessage');
                    if (previewMsg) {
                        previewMsg.remove();
                        conversationHistory = conversationHistory.filter(msg => msg.type !== 'image-preview');
                    }
                    uploadedImage = null;
                }
            }
        }

        // æ·»åŠ é”™è¯¯æ¶ˆæ¯å¹¶æ˜¾ç¤ºé‡è¯•æŒ‰é’®
        function addErrorMessageWithRetry(errorMessage) {
            const messagesContainer = document.getElementById('chatMessages');
            if (!messagesContainer) {
                alert('ç”Ÿæˆå¤±è´¥: ' + errorMessage);
                return;
            }

            const messageDiv = document.createElement('div');
            messageDiv.className = 'message message-assistant';
            const html = `
                <div style="background: rgba(239, 68, 68, 0.1); border: 1px solid rgba(239, 68, 68, 0.3); border-radius: 12px; padding: 16px;">
                    <div style="color: var(--danger); font-weight: 600; margin-bottom: 12px; display: flex; align-items: center; gap: 8px;">
                        <i class="fas fa-exclamation-triangle" style="font-size: 1.2em;"></i>
                        <span>ç”Ÿæˆå¤±è´¥</span>
                    </div>
                    <div style="color: var(--text-secondary); font-size: 0.9em; margin-bottom: 12px;">
                        ${escapeHtml(errorMessage)}
                    </div>
                    <button class="btn btn-primary" onclick="retryLastRequest()" style="width: auto; padding: 10px 20px;">
                        <i class="fas fa-redo" style="margin-right: 4px;"></i> é‡è¯•
                    </button>
                </div>
            `;
            messageDiv.innerHTML = html;
            messagesContainer.appendChild(messageDiv);

            // ä¿å­˜åˆ°å¯¹è¯å†å²
            conversationHistory.push({
                type: 'error',
                html: messageDiv.outerHTML
            });

            scrollToBottom();
        }

        function addLoadingMessage() {
            const messagesContainer = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            const id = 'loading-' + Date.now();
            messageDiv.id = id;
            messageDiv.className = 'message message-assistant';
            messageDiv.innerHTML = `
                <div class="loading">
                    <div class="loading-dot"></div>
                    <div class="loading-dot"></div>
                    <div class="loading-dot"></div>
                </div>
            `;
            messagesContainer.appendChild(messageDiv);
            scrollToBottom();
            return id;
        }

        function removeMessage(id) {
            const element = document.getElementById(id);
            if (element) element.remove();
        }

        function scrollToBottom() {
            const container = document.getElementById('chatContainer');
            container.scrollTop = container.scrollHeight;
        }

        // å·¥å…·å‡½æ•°
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function viewImage(url) {
            window.open(url, '_blank');
        }

        function downloadImage(url) {
            const link = document.createElement('a');
            link.href = url;
            link.download = `AI-Generated-${Date.now()}.png`;
            link.click();
        }

        function continueEdit(url) {
            uploadedImage = url;
            // æ·»åŠ åˆ° uploadedImages æ•°ç»„ä»¥æ”¯æŒç¼©ç•¥å›¾æ˜¾ç¤º
            uploadedImages = [{
                base64: url,
                name: 'å†å²å›¾ç‰‡'
            }];
            // æ˜¾ç¤ºç¼©ç•¥å›¾é¢„è§ˆ
            addImagePreviewMessage(uploadedImages);
            document.getElementById('promptInput').focus();
        }

        // ç¼–è¾‘æç¤ºè¯ï¼ˆå¸¦å›¾ç‰‡ï¼‰
        function editPromptWithImages(messageId) {
            // ä»å¯¹è¯å†å²ä¸­æ‰¾åˆ°å¯¹åº”çš„æ¶ˆæ¯
            const messageData = conversationHistory.find(msg => msg.messageId === messageId);

            if (!messageData) {
                console.error('æœªæ‰¾åˆ°æ¶ˆæ¯æ•°æ®');
                return;
            }

            const text = messageData.text || '';
            const images = messageData.images || [];

            // å°†æç¤ºè¯æ”¾å›è¾“å…¥æ¡†
            const promptInput = document.getElementById('promptInput');
            promptInput.value = text;

            // æ¢å¤å›¾ç‰‡ï¼ˆä¿æŒå½“æ—¶ä½¿ç”¨çš„å‚è€ƒå›¾ï¼‰
            if (images.length > 0) {
                uploadedImages = [...images];
                uploadedImage = images[0].base64;
                // æ˜¾ç¤ºå›¾ç‰‡é¢„è§ˆ
                addImagePreviewMessage(uploadedImages);
            } else {
                // å¦‚æœæ²¡æœ‰å›¾ç‰‡ï¼Œæ¸…ç©º
                uploadedImages = [];
                uploadedImage = null;
            }

            // è‡ªåŠ¨è°ƒæ•´è¾“å…¥æ¡†é«˜åº¦
            promptInput.style.height = 'auto';
            promptInput.style.height = Math.min(promptInput.scrollHeight, 200) + 'px';

            // æ»šåŠ¨åˆ°è¾“å…¥æ¡†å¹¶èšç„¦
            promptInput.scrollIntoView({ behavior: 'smooth', block: 'center' });
            promptInput.focus();

            // å°†å…‰æ ‡ç§»åˆ°æ–‡æœ¬æœ«å°¾
            promptInput.setSelectionRange(text.length, text.length);
        }

        // åŠ è½½å†å²è®°å½•
        async function loadHistory() {
            if (!db) {
                console.warn('æ•°æ®åº“æœªåˆå§‹åŒ–');
                return;
            }

            return new Promise((resolve, reject) => {
                const transaction = db.transaction([STORE_NAME], 'readonly');
                const objectStore = transaction.objectStore(STORE_NAME);
                const index = objectStore.index('timestamp');
                const request = index.openCursor(null, 'prev');

                imageHistory = [];

                request.onsuccess = (event) => {
                    const cursor = event.target.result;
                    if (cursor && imageHistory.length < 50) {
                        imageHistory.push(cursor.value);
                        cursor.continue();
                    } else {
                        console.log('åŠ è½½å†å²è®°å½•æˆåŠŸï¼Œå…±', imageHistory.length, 'æ¡');
                        resolve();
                    }
                };

                request.onerror = () => {
                    console.error('åŠ è½½å†å²è®°å½•å¤±è´¥:', request.error);
                    reject(request.error);
                };
            });
        }

        // ä¿å­˜åˆ°å†å²è®°å½•
        async function saveToHistory(imageUrl, prompt, dimensions) {
            if (!db) return;

            const historyItem = {
                url: imageUrl,
                prompt: prompt,
                dimensions: dimensions,
                timestamp: new Date().toISOString()
            };

            return new Promise((resolve, reject) => {
                const transaction = db.transaction([STORE_NAME], 'readwrite');
                const objectStore = transaction.objectStore(STORE_NAME);
                const request = objectStore.add(historyItem);

                request.onsuccess = () => {
                    imageHistory.unshift(historyItem);
                    if (imageHistory.length > 50) {
                        imageHistory = imageHistory.slice(0, 50);
                    }
                    resolve();
                };

                request.onerror = () => {
                    console.error('ä¿å­˜å†å²è®°å½•å¤±è´¥:', request.error);
                    reject(request.error);
                };
            });
        }

        // æ¸…ç©ºå†å²è®°å½•
        async function clearHistory() {
            if (!confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰å†å²è®°å½•å—ï¼Ÿ')) return;
            if (!db) return;

            const transaction = db.transaction([STORE_NAME], 'readwrite');
            const objectStore = transaction.objectStore(STORE_NAME);
            const request = objectStore.clear();

            request.onsuccess = () => {
                imageHistory = [];
                addSystemMessage('<i class="fas fa-check-circle" style="color: var(--success); margin-right: 4px;"></i> å†å²è®°å½•å·²æ¸…ç©º');
            };
        }

        // ========== å¯¹è¯ç®¡ç†åŠŸèƒ½ ==========

        // åŠ è½½æ‰€æœ‰å¯¹è¯
        async function loadConversations() {
            if (!db) return;

            return new Promise((resolve, reject) => {
                const transaction = db.transaction([CONVERSATION_STORE], 'readonly');
                const objectStore = transaction.objectStore(CONVERSATION_STORE);
                const index = objectStore.index('lastUpdated');
                const request = index.openCursor(null, 'prev');

                conversations = [];

                request.onsuccess = (event) => {
                    const cursor = event.target.result;
                    if (cursor) {
                        conversations.push(cursor.value);
                        cursor.continue();
                    } else {
                        console.log('åŠ è½½å¯¹è¯åˆ—è¡¨æˆåŠŸï¼Œå…±', conversations.length, 'æ¡');
                        updateConversationList();
                        resolve();
                    }
                };

                request.onerror = () => {
                    console.error('åŠ è½½å¯¹è¯åˆ—è¡¨å¤±è´¥:', request.error);
                    reject(request.error);
                };
            });
        }

        // åˆ›å»ºæ–°å¯¹è¯æˆ–åŠ è½½æœ€è¿‘çš„å¯¹è¯
        async function createOrLoadConversation() {
            // ä¼˜å…ˆè¯»å–ä¸Šæ¬¡çš„å¯¹è¯ID
            const lastConversationId = localStorage.getItem('currentConversationId');

            if (lastConversationId && conversations.find(c => c.id === parseInt(lastConversationId))) {
                // åŠ è½½ä¸Šæ¬¡çš„å¯¹è¯
                await loadConversation(parseInt(lastConversationId));
            } else if (conversations.length > 0) {
                // åŠ è½½æœ€è¿‘çš„å¯¹è¯
                await loadConversation(conversations[0].id);
            } else {
                // åˆ›å»ºç¬¬ä¸€ä¸ªå¯¹è¯
                await createNewConversation();
            }
        }

        // åˆ›å»ºæ–°å¯¹è¯
        async function createNewConversation() {
            if (!db) {
                console.error('æ•°æ®åº“æœªåˆå§‹åŒ–ï¼Œæ— æ³•åˆ›å»ºæ–°å¯¹è¯');
                alert('æ•°æ®åº“æœªåˆå§‹åŒ–ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•');
                return;
            }

            // å…ˆä¿å­˜å½“å‰å¯¹è¯ï¼ˆå¦‚æœæœ‰ï¼‰
            if (currentConversationId && conversationHistory.length > 0) {
                await saveCurrentConversation();
            }

            const newConversation = {
                title: 'æ–°å¯¹è¯',
                messages: [],
                timestamp: new Date().toISOString(),
                lastUpdated: new Date().toISOString()
            };

            return new Promise((resolve, reject) => {
                try {
                    const transaction = db.transaction([CONVERSATION_STORE], 'readwrite');
                    const objectStore = transaction.objectStore(CONVERSATION_STORE);
                    const request = objectStore.add(newConversation);

                    request.onsuccess = () => {
                        const newId = request.result;
                        newConversation.id = newId;
                        conversations.unshift(newConversation);
                        currentConversationId = newId;
                        conversationHistory = [];

                        // ä¿å­˜åˆ°localStorage
                        localStorage.setItem('currentConversationId', newId);

                        // æ¸…ç©ºå½“å‰å¯¹è¯ç•Œé¢
                        displayChatView();
                        updateConversationList();

                        // åœ¨ç§»åŠ¨ç«¯å…³é—­ä¾§è¾¹æ 
                        if (window.innerWidth <= 768) {
                            closeSidebar();
                        }

                        resolve(newId);
                    };

                    request.onerror = () => {
                        console.error('åˆ›å»ºæ–°å¯¹è¯å¤±è´¥:', request.error);
                        reject(request.error);
                    };
                } catch (error) {
                    console.error('åˆ›å»ºæ–°å¯¹è¯å¼‚å¸¸:', error);
                    reject(error);
                }
            });
        }

        // åŠ è½½æŒ‡å®šå¯¹è¯
        async function loadConversation(conversationId) {
            if (!db) return;

            // å…ˆä¿å­˜å½“å‰å¯¹è¯
            if (currentConversationId && conversationHistory.length > 0) {
                await saveCurrentConversation();
            }

            return new Promise((resolve, reject) => {
                const transaction = db.transaction([CONVERSATION_STORE], 'readonly');
                const objectStore = transaction.objectStore(CONVERSATION_STORE);
                const request = objectStore.get(conversationId);

                request.onsuccess = () => {
                    const conversation = request.result;
                    if (conversation) {
                        currentConversationId = conversationId;
                        conversationHistory = conversation.messages || [];

                        // ä¿å­˜åˆ°localStorage
                        localStorage.setItem('currentConversationId', conversationId);

                        // åˆ‡æ¢åˆ°èŠå¤©è§†å›¾å¹¶æ˜¾ç¤ºå¯¹è¯
                        if (currentView !== 'chat') {
                            switchView('chat');
                        } else {
                            // å¼ºåˆ¶åˆ·æ–°èŠå¤©ç•Œé¢
                            displayChatView();
                            // æ»šåŠ¨åˆ°åº•éƒ¨
                            setTimeout(() => {
                                const chatContainer = document.getElementById('chatContainer');
                                if (chatContainer) {
                                    chatContainer.scrollTop = chatContainer.scrollHeight;
                                }
                            }, 100);
                            // å³ä½¿å½“å‰å·²ç»æ˜¯èŠå¤©è§†å›¾ï¼Œåœ¨ç§»åŠ¨ç«¯ä¹Ÿè¦å…³é—­ä¾§è¾¹æ 
                            if (window.innerWidth <= 768) {
                                closeSidebar();
                            }
                        }

                        updateConversationList();
                        console.log('åŠ è½½å¯¹è¯æˆåŠŸï¼ŒID:', conversationId);
                        resolve();
                    } else {
                        reject(new Error('å¯¹è¯ä¸å­˜åœ¨'));
                    }
                };

                request.onerror = () => {
                    console.error('åŠ è½½å¯¹è¯å¤±è´¥:', request.error);
                    reject(request.error);
                };
            });
        }

        // ä¿å­˜å½“å‰å¯¹è¯
        async function saveCurrentConversation(updateUI = true) {
            if (!db) {
                console.error('æ•°æ®åº“æœªåˆå§‹åŒ–ï¼Œæ— æ³•ä¿å­˜');
                return;
            }
            if (!currentConversationId) {
                console.error('æ²¡æœ‰å½“å‰å¯¹è¯IDï¼Œæ— æ³•ä¿å­˜');
                return;
            }
            if (conversationHistory.length === 0) {
                return;
            }

            // ç”Ÿæˆå¯¹è¯æ ‡é¢˜ï¼ˆä½¿ç”¨ç¬¬ä¸€æ¡ç”¨æˆ·æ¶ˆæ¯ï¼‰
            let title = 'æ–°å¯¹è¯';
            const firstUserMsg = conversationHistory.find(msg => msg.type === 'user');
            if (firstUserMsg) {
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = firstUserMsg.html;
                const text = tempDiv.textContent || tempDiv.innerText || '';
                title = text.substring(0, 10) + (text.length > 10 ? '...' : '');
            }

            return new Promise((resolve, reject) => {
                try {
                    const transaction = db.transaction([CONVERSATION_STORE], 'readwrite');
                    const objectStore = transaction.objectStore(CONVERSATION_STORE);
                    const request = objectStore.get(currentConversationId);

                    request.onsuccess = () => {
                        const conversation = request.result;
                        if (conversation) {
                            conversation.messages = conversationHistory;
                            conversation.title = title;
                            conversation.lastUpdated = new Date().toISOString();

                            const updateRequest = objectStore.put(conversation);
                            updateRequest.onsuccess = () => {
                                // æ›´æ–°æœ¬åœ°åˆ—è¡¨
                                const index = conversations.findIndex(c => c.id === currentConversationId);
                                if (index !== -1) {
                                    conversations[index] = conversation;
                                    // ç§»åˆ°æœ€å‰é¢
                                    conversations.splice(index, 1);
                                    conversations.unshift(conversation);
                                }

                                // åªåœ¨éœ€è¦æ—¶æ›´æ–°UI
                                if (updateUI) {
                                    updateConversationList();
                                }
                                resolve();
                            };

                            updateRequest.onerror = () => {
                                console.error('ä¿å­˜å¯¹è¯å¤±è´¥:', updateRequest.error);
                                reject(updateRequest.error);
                            };
                        } else {
                            // å¯¹è¯ä¸å­˜åœ¨ï¼ˆå¯èƒ½å·²è¢«åˆ é™¤ï¼‰ï¼Œè·³è¿‡ä¿å­˜
                            console.warn('å¯¹è¯ä¸å­˜åœ¨ï¼Œè·³è¿‡ä¿å­˜');
                            resolve();
                        }
                    };

                    request.onerror = () => {
                        console.error('è·å–å¯¹è¯å¤±è´¥:', request.error);
                        reject(request.error);
                    };
                } catch (error) {
                    console.error('ä¿å­˜å¯¹è¯å¼‚å¸¸:', error);
                    reject(error);
                }
            });
        }

        // åˆ é™¤å¯¹è¯
        async function deleteConversation(conversationId) {
            if (!db) return;
            if (!confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå¯¹è¯å—ï¼Ÿ')) return;

            return new Promise((resolve, reject) => {
                const transaction = db.transaction([CONVERSATION_STORE], 'readwrite');
                const objectStore = transaction.objectStore(CONVERSATION_STORE);
                const request = objectStore.delete(conversationId);

                request.onsuccess = async () => {
                    // ä»åˆ—è¡¨ä¸­ç§»é™¤
                    conversations = conversations.filter(c => c.id !== conversationId);

                    // å¦‚æœåˆ é™¤çš„æ˜¯å½“å‰å¯¹è¯
                    if (currentConversationId === conversationId) {
                        // æ¸…é™¤localStorageå’Œå½“å‰å¯¹è¯æ•°æ®
                        localStorage.removeItem('currentConversationId');
                        currentConversationId = null;
                        conversationHistory = [];

                        // ç«‹å³æ¸…ç©ºèŠå¤©ç•Œé¢
                        const chatContainer = document.getElementById('chatContainer');
                        if (chatContainer) {
                            chatContainer.innerHTML = '<div class="chat-messages" id="chatMessages"></div>';
                        }

                        // å¦‚æœè¿˜æœ‰å…¶ä»–å¯¹è¯ï¼Œåˆ‡æ¢åˆ°ç¬¬ä¸€ä¸ª
                        if (conversations.length > 0) {
                            await loadConversation(conversations[0].id);
                        } else {
                            // æ²¡æœ‰å…¶ä»–å¯¹è¯äº†ï¼Œåˆ›å»ºæ–°å¯¹è¯
                            await createNewConversation();
                        }
                    } else {
                        // åˆ é™¤çš„ä¸æ˜¯å½“å‰å¯¹è¯ï¼Œåªéœ€æ›´æ–°UI
                        updateConversationList();

                        // å¦‚æœå½“å‰åœ¨å†å²è®°å½•è§†å›¾ï¼Œåˆ·æ–°æ˜¾ç¤º
                        if (currentView === 'history') {
                            displayHistoryView();
                        }
                    }

                    resolve();
                };

                request.onerror = () => {
                    console.error('åˆ é™¤å¯¹è¯å¤±è´¥:', request.error);
                    reject(request.error);
                };
            });
        }

        // æ›´æ–°ä¾§è¾¹æ å¯¹è¯åˆ—è¡¨
        function updateConversationList() {
            const container = document.querySelector('.sidebar-section');
            if (!container) return;

            // æŸ¥æ‰¾æˆ–åˆ›å»ºå¯¹è¯åˆ—è¡¨åŒºåŸŸ
            let convSection = document.getElementById('conversationListSection');
            if (!convSection) {
                convSection = document.createElement('div');
                convSection.id = 'conversationListSection';
                convSection.className = 'sidebar-section';
                convSection.style.flex = '1';
                convSection.style.overflowY = 'auto';
                convSection.style.minHeight = '0';
                convSection.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 0 12px; margin-bottom: 8px;">
                        <div class="sidebar-section-title" style="margin: 0;">å¯¹è¯åˆ—è¡¨</div>
                        <button onclick="createNewConversation()" style="background: var(--accent-primary); color: white; border: none; border-radius: 6px; padding: 4px 8px; font-size: 0.85em; cursor: pointer; transition: background 0.2s;" onmouseover="this.style.background='var(--accent-hover)'" onmouseout="this.style.background='var(--accent-primary)'" title="æ–°å»ºå¯¹è¯">
                            <i class="fas fa-plus" style="margin-right: 2px;"></i> æ–°å»º
                        </button>
                    </div>
                    <div id="conversationList" style="overflow-y: auto;"></div>
                `;
                // æ’å…¥åˆ°ç¬¬ä¸€ä¸ª sidebar-section åé¢
                const firstSection = document.querySelector('.sidebar-section');
                if (firstSection && firstSection.nextSibling) {
                    firstSection.parentNode.insertBefore(convSection, firstSection.nextSibling);
                }
            }

            const listContainer = document.getElementById('conversationList');
            if (!listContainer) return;

            // ç”Ÿæˆå¯¹è¯åˆ—è¡¨
            listContainer.innerHTML = conversations.slice(0, 20).map(conv => {
                const isActive = conv.id === currentConversationId;
                const date = new Date(conv.lastUpdated);
                const timeStr = date.toLocaleString('zh-CN', {
                    month: '2-digit',
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit'
                });

                return `
                    <div class="sidebar-item ${isActive ? 'active' : ''}"
                         onclick="loadConversation(${conv.id})"
                         style="display: flex; justify-content: space-between; align-items: center; position: relative; padding-right: 36px;">
                        <div style="flex: 1; overflow: hidden;">
                            <div style="font-size: 0.9em; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
                                ${escapeHtml(conv.title || 'æ–°å¯¹è¯')}
                            </div>
                            <div style="font-size: 0.75em; color: var(--text-tertiary); margin-top: 2px;">
                                ${timeStr}
                            </div>
                        </div>
                        <button onclick="event.stopPropagation(); deleteConversation(${conv.id})"
                                style="position: absolute; right: 8px; background: transparent; border: none; color: var(--text-tertiary); cursor: pointer; padding: 4px; border-radius: 4px; font-size: 0.9em; display: flex; align-items: center; justify-content: center;"
                                onmouseover="this.style.background='var(--bg-hover)'; this.style.color='var(--danger)';"
                                onmouseout="this.style.background='transparent'; this.style.color='var(--text-tertiary)';"
                                title="åˆ é™¤å¯¹è¯">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
            }).join('');
        }

        // è§†å›¾åˆ‡æ¢
        function switchView(view) {
            currentView = view;
            const chatContainer = document.getElementById('chatContainer');

            // æ›´æ–°ä¾§è¾¹æ æ¿€æ´»çŠ¶æ€
            document.querySelectorAll('.sidebar-item').forEach(item => {
                item.classList.remove('active');
            });
            // ä½¿ç”¨ event å¯¹è±¡ï¼ˆå¦‚æœå­˜åœ¨ä¸”æœ‰ target å±æ€§ï¼‰
            if (typeof event !== 'undefined' && event && event.target && typeof event.target.closest === 'function') {
                try {
                    const sidebarItem = event.target.closest('.sidebar-item');
                    if (sidebarItem) {
                        sidebarItem.classList.add('active');
                    }
                } catch (e) {
                    // å¿½ç•¥é”™è¯¯ï¼Œç»§ç»­æ‰§è¡Œ
                }
            }

            // æ ¹æ®è§†å›¾æ˜¾ç¤ºä¸åŒå†…å®¹
            if (view === 'history') {
                displayHistoryView();
            } else {
                displayChatView();
            }

            // ç§»åŠ¨ç«¯å…³é—­ä¾§è¾¹æ 
            if (window.innerWidth <= 768) {
                closeSidebar();
            }
        }

        // æ˜¾ç¤ºèŠå¤©è§†å›¾
        function displayChatView() {
            const chatContainer = document.getElementById('chatContainer');

            // å¦‚æœå·²ç»æœ‰å¯¹è¯å†å²ï¼Œæ¢å¤å®ƒ
            if (conversationHistory.length > 0) {
                chatContainer.innerHTML = '<div class="chat-messages" id="chatMessages"></div>';
                const messagesContainer = document.getElementById('chatMessages');

                // æ¢å¤æ‰€æœ‰å†å²æ¶ˆæ¯
                conversationHistory.forEach(msg => {
                    const messageDiv = document.createElement('div');
                    messageDiv.innerHTML = msg.html;
                    messagesContainer.appendChild(messageDiv.firstElementChild);
                });
            } else {
                // é¦–æ¬¡è¿›å…¥ï¼Œæ˜¾ç¤ºæ¬¢è¿æ¶ˆæ¯
                chatContainer.innerHTML = `
                    <div class="chat-messages" id="chatMessages">
                        <div class="message message-assistant">
                            <div class="message-text">
                                <i class="fas fa-robot" style="margin-right: 6px; color: var(--accent-primary);"></i>
                                ä½ å¥½ï¼æˆ‘æ˜¯ AI å›¾ç‰‡ç”ŸæˆåŠ©æ‰‹ã€‚<br>
                                è¯·æè¿°ä½ æƒ³è¦ç”Ÿæˆçš„å›¾ç‰‡ï¼Œæˆ–ä¸Šä¼ å‚è€ƒå›¾ç‰‡è¿›è¡Œç¼–è¾‘ã€‚
                            </div>
                        </div>
                    `;
            }
        }

        // æ˜¾ç¤ºå†å²è®°å½•è§†å›¾ï¼ˆæ˜¾ç¤ºæ‰€æœ‰å¯¹è¯ï¼‰
        function displayHistoryView() {
            const chatContainer = document.getElementById('chatContainer');

            if (conversations.length === 0) {
                chatContainer.innerHTML = `
                    <div style="text-align: center; padding: 60px 20px; color: var(--text-tertiary);">
                        <i class="fas fa-history" style="font-size: 3em; margin-bottom: 16px; color: var(--accent-primary);"></i>
                        <div style="font-size: 1.1em; margin-bottom: 8px; color: var(--text-secondary);">æš‚æ— å†å²å¯¹è¯</div>
                        <div style="font-size: 0.9em;">å¼€å§‹æ–°å¯¹è¯åä¼šè‡ªåŠ¨ä¿å­˜åœ¨è¿™é‡Œ</div>
                    </div>
                `;
                return;
            }

            let html = `
                <div style="max-width: 1200px; margin: 0 auto; padding: 16px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 12px;">
                        <h2 style="font-size: clamp(1.2em, 4vw, 1.5em); font-weight: 600; color: var(--text-primary); margin: 0;">å†å²å¯¹è¯ (${conversations.length})</h2>
                    </div>
                    <div style="display: flex; flex-direction: column; gap: 12px;">
            `;

            conversations.forEach((conv, index) => {
                const date = new Date(conv.lastUpdated);
                const timeStr = date.toLocaleString('zh-CN', {
                    month: '2-digit',
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit'
                });

                // ç»Ÿè®¡å¯¹è¯ä¸­çš„æ¶ˆæ¯æ•°é‡
                const messageCount = conv.messages ? conv.messages.length : 0;
                const userMessages = conv.messages ? conv.messages.filter(m => m.type === 'user').length : 0;
                const assistantMessages = conv.messages ? conv.messages.filter(m => m.type === 'assistant').length : 0;

                // è·å–ç¬¬ä¸€å¼ å›¾ç‰‡ä½œä¸ºé¢„è§ˆ
                let previewImage = '';
                if (conv.messages) {
                    const imgMsg = conv.messages.find(m => m.type === 'assistant' && m.imageUrl);
                    if (imgMsg && imgMsg.imageUrl) {
                        previewImage = `
                            <div style="flex-shrink: 0; display: none;" class="history-preview-img">
                                <img src="${imgMsg.imageUrl}"
                                     style="width: 80px; height: 80px; object-fit: cover; border-radius: 8px; cursor: pointer;"
                                     onclick="event.stopPropagation(); viewImageInModal('${imgMsg.imageUrl}')">
                            </div>
                        `;
                    }
                }

                html += `
                    <div style="background: var(--bg-secondary); border-radius: 12px; padding: 12px; border: 1px solid var(--border-color); transition: all 0.2s; cursor: pointer;"
                         onmouseover="this.style.boxShadow='0 4px 12px rgba(0,0,0,0.3)'; this.style.borderColor='var(--accent-primary)'"
                         onmouseout="this.style.boxShadow='none'; this.style.borderColor='var(--border-color)'"
                         onclick="loadConversation(${conv.id})">
                        <div style="display: flex; gap: 12px; align-items: start; flex-wrap: wrap;">
                            ${previewImage}
                            <div style="flex: 1; min-width: 0;">
                                <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 6px; gap: 8px;">
                                    <h3 style="font-size: 1.1em; font-weight: 600; color: var(--text-primary); margin: 0; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; flex: 1; min-width: 0;">
                                        ${escapeHtml(conv.title || 'æ–°å¯¹è¯')}
                                    </h3>
                                    <button onclick="event.stopPropagation(); deleteConversation(${conv.id})"
                                            style="background: transparent; border: none; color: var(--text-tertiary); cursor: pointer; padding: 4px 8px; border-radius: 4px; font-size: 1em; flex-shrink: 0; display: flex; align-items: center; justify-content: center;"
                                            onmouseover="this.style.background='var(--bg-hover)'; this.style.color='var(--danger)';"
                                            onmouseout="this.style.background='transparent'; this.style.color='var(--text-tertiary)';"
                                            title="åˆ é™¤å¯¹è¯">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                                <div style="font-size: 0.85em; color: var(--text-tertiary); margin-bottom: 8px;">
                                    ${timeStr} Â· ${messageCount} æ¡æ¶ˆæ¯ (${userMessages} ä¸ªæé—®, ${assistantMessages} ä¸ªå›å¤)
                                </div>
                                <div style="font-size: 0.9em; color: var(--text-secondary); line-height: 1.4;">
                                    ç‚¹å‡»æŸ¥çœ‹å®Œæ•´å¯¹è¯
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            });

            html += `</div></div>`;
            chatContainer.innerHTML = html;
        }

        // ä¾§è¾¹æ åˆ‡æ¢
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            sidebar.classList.toggle('open');
            overlay.classList.toggle('active');
        }

        function closeSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            sidebar.classList.remove('open');
            overlay.classList.remove('active');
        }

        // ç©ºç™½å›¾ç‰‡ç”ŸæˆåŠŸèƒ½
        function showBlankImageModal() {
            document.getElementById('blankImageModal').classList.add('active');
            // é»˜è®¤é€‰ä¸­ç¬¬ä¸€ä¸ªé€‰é¡¹
            const firstRatio = document.querySelector('.ratio-option[data-ratio="9:16"]');
            const firstColor = document.querySelector('.color-option[data-color="#FFFFFF"]');
            if (firstRatio) firstRatio.classList.add('active');
            if (firstColor) firstColor.classList.add('active');
        }

        function closeBlankImageModal() {
            document.getElementById('blankImageModal').classList.remove('active');
        }

        function selectBlankRatio(ratio, element) {
            selectedBlankRatio = ratio;
            document.querySelectorAll('.ratio-option').forEach(btn => btn.classList.remove('active'));
            element.classList.add('active');
        }

        function selectBlankColor(color, element) {
            selectedBlankColor = color;
            document.querySelectorAll('.color-option').forEach(btn => btn.classList.remove('active'));
            element.classList.add('active');
        }

        function generateBlankImage() {
            const ratioMap = {
                '9:16': { width: 768, height: 1365 },
                '16:9': { width: 1344, height: 768 },
                '1:1': { width: 1024, height: 1024 },
                '4:3': { width: 1344, height: 1008 }
            };

            const size = ratioMap[selectedBlankRatio];
            const canvas = document.createElement('canvas');
            canvas.width = size.width;
            canvas.height = size.height;

            const ctx = canvas.getContext('2d');
            ctx.fillStyle = selectedBlankColor;
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            const blankImageBase64 = canvas.toDataURL('image/jpeg', 0.9);
            uploadedImage = blankImageBase64;
            uploadedImages.push({
                base64: blankImageBase64,
                name: `ç©ºç™½å›¾-${selectedBlankRatio}.jpg`
            });

            closeBlankImageModal();

            // åˆ‡æ¢åˆ°èŠå¤©è§†å›¾å¹¶æç¤º
            if (currentView !== 'chat') {
                switchView('chat');
            }
            setTimeout(() => {
                addSystemMessage(`å·²ç”Ÿæˆ ${selectedBlankRatio} æ¯”ä¾‹çš„ç©ºç™½å›¾ç‰‡ (${size.width}x${size.height})ï¼Œè¯·è¾“å…¥æç¤ºè¯`);
                document.getElementById('promptInput').focus();
            }, 100);
        }

        // å¤šå›¾ä¸Šä¼ å¤„ç†
        // å‹ç¼©å›¾ç‰‡ï¼ˆæ™ºèƒ½é€‰æ‹©æœ€å°å°ºå¯¸ï¼‰
        function compressImage(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const originalDataUrl = e.target.result;
                    const originalSize = originalDataUrl.length;

                    const img = new Image();
                    img.onload = function() {
                        // åˆ›å»ºcanvas
                        const canvas = document.createElement('canvas');
                        const ctx = canvas.getContext('2d');

                        // ä¿æŒåŸå§‹åˆ†è¾¨ç‡
                        canvas.width = img.width;
                        canvas.height = img.height;

                        // ç»˜åˆ¶å›¾ç‰‡
                        ctx.drawImage(img, 0, 0, img.width, img.height);

                        // å°è¯•ä¸åŒçš„å‹ç¼©æ–¹æ¡ˆï¼Œé€‰æ‹©æœ€å°çš„
                        const candidates = [];

                        // æ–¹æ¡ˆ1: JPEG 90%
                        candidates.push({
                            data: canvas.toDataURL('image/jpeg', 0.9),
                            format: 'JPEG 90%'
                        });

                        // æ–¹æ¡ˆ2: JPEG 80%
                        candidates.push({
                            data: canvas.toDataURL('image/jpeg', 0.8),
                            format: 'JPEG 80%'
                        });

                        // æ–¹æ¡ˆ3: JPEG 70%
                        candidates.push({
                            data: canvas.toDataURL('image/jpeg', 0.7),
                            format: 'JPEG 70%'
                        });

                        // æ–¹æ¡ˆ4: PNGï¼ˆå¦‚æœåŸå›¾æ˜¯PNGï¼‰
                        if (file.type === 'image/png') {
                            candidates.push({
                                data: canvas.toDataURL('image/png'),
                                format: 'PNG'
                            });
                        }

                        // æ–¹æ¡ˆ5: åŸå›¾
                        candidates.push({
                            data: originalDataUrl,
                            format: 'åŸå›¾'
                        });

                        // é€‰æ‹©æœ€å°çš„
                        let bestCandidate = candidates[0];
                        for (const candidate of candidates) {
                            if (candidate.data.length < bestCandidate.data.length) {
                                bestCandidate = candidate;
                            }
                        }

                        const compressedSize = bestCandidate.data.length;

                        resolve({
                            base64: bestCandidate.data,
                            name: file.name,
                            originalSize,
                            compressedSize,
                            format: bestCandidate.format
                        });
                    };
                    img.onerror = reject;
                    img.src = originalDataUrl;
                };
                reader.onerror = reject;
                reader.readAsDataURL(file);
            });
        }

        function handleImageUpload(event) {
            const files = event.target.files;
            if (!files || files.length === 0) return;

            let loadedCount = 0;
            const totalFiles = files.length;

            // æ˜¾ç¤ºåŠ è½½æç¤º
            addSystemMessage('<i class="fas fa-spinner fa-spin" style="margin-right: 4px;"></i> æ­£åœ¨ä¼˜åŒ–å›¾ç‰‡...');

            Array.from(files).forEach((file, index) => {
                // æ™ºèƒ½å‹ç¼©å›¾ç‰‡
                compressImage(file).then(result => {
                    uploadedImages.push({
                        base64: result.base64,
                        name: result.name
                    });
                    uploadedImage = result.base64; // ä¿æŒå…¼å®¹æ€§

                    loadedCount++;
                    if (loadedCount === totalFiles) {
                        if (currentView !== 'chat') {
                            switchView('chat');
                        }
                        setTimeout(() => {
                            // æ˜¾ç¤ºå›¾ç‰‡ç¼©ç•¥å›¾
                            addImagePreviewMessage(uploadedImages);
                            document.getElementById('promptInput').focus();
                        }, 100);
                    }
                }).catch(error => {
                    console.error('å›¾ç‰‡å¤„ç†å¤±è´¥:', error);
                    // å¦‚æœå¤„ç†å¤±è´¥ï¼Œä½¿ç”¨åŸå›¾
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        uploadedImages.push({
                            base64: e.target.result,
                            name: file.name
                        });
                        uploadedImage = e.target.result;

                        loadedCount++;
                        if (loadedCount === totalFiles) {
                            if (currentView !== 'chat') {
                                switchView('chat');
                            }
                            setTimeout(() => {
                                addImagePreviewMessage(uploadedImages);
                                document.getElementById('promptInput').focus();
                            }, 100);
                        }
                    };
                    reader.readAsDataURL(file);
                });
            });
        }
        // å›¾ç‰‡æŸ¥çœ‹å™¨å‡½æ•°
        function viewImageInModal(url) {
            const modal = document.getElementById('imageViewerModal');
            const img = document.getElementById('imageViewerImg');
            img.src = url;
            modal.classList.add('active');
        }

        function closeImageViewer() {
            const modal = document.getElementById('imageViewerModal');
            modal.classList.remove('active');
        }

        // ç‚¹å‡»æ¨¡æ€æ¡†èƒŒæ™¯å…³é—­
        document.addEventListener('DOMContentLoaded', () => {
            const modal = document.getElementById('imageViewerModal');
            if (modal) {
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        closeImageViewer();
                    }
                });
            }
        });
    </script>

    <!-- å›¾ç‰‡æŸ¥çœ‹å™¨æ¨¡æ€æ¡† -->
    <div class="image-viewer-modal" id="imageViewerModal">
        <div class="image-viewer-content">
            <button class="image-viewer-close" onclick="closeImageViewer()">Ã—</button>
            <img id="imageViewerImg" src="" alt="æŸ¥çœ‹å›¾ç‰‡">
        </div>
    </div>
</body>
</html>
